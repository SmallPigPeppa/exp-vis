import matplotlib.pyplot as plt
import tqdm

if __name__ == '__main__':
    # baseline = [0.77720106, 0.9027923, 0.93553984, 0.9530828, 0.9843759, 0.9255388, 0.90468335, 0.9038323, 0.9004502,
    #             0.8737948, 0.8530644, 0.86466086, 0.8662614, 0.8578013, 0.79811126, 0.7241028, 0.56179476]
    # baseline = [0.56441814, 0.901055, 0.92424685, 0.9319522, 0.9567807, 0.9206414, 0.91153145, 0.91597825, 0.89106226,
    #             0.8644485, 0.83637595, 0.82349586, 0.8072005, 0.81212515, 0.7608241, 0.6475792, 0.4481903]
    baseline=[0.5217265, 0.84044707, 0.8621084, 0.8698506, 0.9034742, 0.85664743, 0.84769034, 0.8497274, 0.8305221, 0.8060081, 0.78501016, 0.78600293, 0.777805, 0.7729695, 0.7274897, 0.67207044, 0.44927087]
    top=[0.49335366, 0.87244684, 0.918184, 0.9266268, 0.9128299, 0.92045224, 0.90888965, 0.9026822, 0.8848134, 0.8772897, 0.87315214, 0.86943644, 0.86870414, 0.8621362, 0.85267985, 0.8338663, 0.72552055]
    # top=[0.87736046, 0.87244684, 0.918184, 0.9266268, 0.9128299, 0.92045224, 0.90888965, 0.9026822, 0.8848134, 0.8772897, 0.87315214, 0.86943644, 0.86870414, 0.8621362, 0.85267985, 0.8338663, 0.72552055]

    msc = [0.8838564, 0.9789435, 0.8894316, 0.8876862, 0.9179047, 0.90681535, 0.8862407, 0.9042726, 0.9248213,
           0.90901494, 0.87998414, 0.8643188, 0.850467, 0.8399346, 0.8195594, 0.75693095, 0.6708553]
    msc=[0.8634358, 0.94369876, 0.81595486, 0.8129707, 0.87913734, 0.8576591, 0.8305283, 0.8486107, 0.8883139, 0.87344, 0.8467736, 0.84380245, 0.83260703, 0.815776, 0.7819937, 0.7419545, 0.60931206]
    msc2 = [0.74638385, 0.932775, 0.8432576, 0.9555851, 0.9595746, 0.8798799, 0.8258886, 0.79888946, 0.82203156,
            0.8378746, 0.81841093, 0.815157, 0.83050746, 0.7711535, 0.86765826, 0.83113533, 0.8400831]
    msc3 = [0.75253665, 0.90540105, 0.9365608, 0.58071893, 0.79839915, 0.7611071, 0.74646425, 0.3178838, 0.23853931,
            0.20858005, 0.19507046, 0.18455009, 0.17904072, 0.19950123, 0.18176273, 0.12592436, 0.84232354]



    fig, axs = plt.subplots(1, 1, layout='constrained', figsize=(4 / 0.8, 4))
    # , figsize = (40, 5)
    ax = axs
    ax.set_xlabel("Block Index", fontsize=12)
    ax.set_ylabel("CKA", fontsize=12)
    ax.set_title(f"Imagenet100", fontsize=12, loc='right')
    ax.set_title(f"Resnet50", fontsize=12, loc='left')
    ax.plot(baseline)
    ax.plot(msc)
    # ax.plot(top)
    # ax.plot(msc2)
    # ax.plot(msc3)
    ax.grid()

    plt.show()
    fig.savefig('resnet50.png')
