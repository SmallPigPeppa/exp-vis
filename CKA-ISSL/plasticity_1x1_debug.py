import numpy as np
import matplotlib.pyplot as plt

joint = [[1.0] * 9] * 9

fix = [[0.99770314, 0.97815824, 0.97815824, 0.9820196, 0.9930763, 0.9930763, 0.99040073, 0.9864058, 0.9820196,
        0.9064485, 0.950826, 0.950826, 0.91496277, 0.8955792, 0.9064485, 0.8744784, 0.8490198, 0.8490198, 0.8403045,
        0.85245323, 0.8744784, 0.8055212, 0.8149314, 0.8149314, 0.8548404, 0.85254794, 0.8055212, 0.71988684, 0.7343633,
        0.7343633, 0.67415357, 0.68194896, 0.71988684, 0.68487346, 0.7026244, 0.7026244, 0.72046095, 0.71650237,
        0.68487346, 0.58024246, 0.5815882, 0.5815882, 0.6083747, 0.60687625, 0.58024246, 0.46870872, 0.4676761,
        0.4676761, 0.5235659, 0.52155, 0.46870872],
       [0.99763954, 0.98626894, 0.98626894, 0.9831154, 0.99241954, 0.99241954, 0.9914701, 0.98703194, 0.9831154,
        0.8919045, 0.9475615, 0.9475615, 0.90461814, 0.88380075, 0.8919045, 0.8609498, 0.83137137, 0.83137137,
        0.83002293, 0.8346703, 0.8609498, 0.7752965, 0.7889293, 0.7889293, 0.81763244, 0.81429464, 0.7752965,
        0.69793594, 0.71006703, 0.71006703, 0.621739, 0.6327409, 0.69793594, 0.6648508, 0.68079656, 0.68079656,
        0.7228257, 0.71690845, 0.6648508, 0.58548486, 0.5702767, 0.5702767, 0.5938263, 0.589765, 0.58548486, 0.46262038,
        0.47141227, 0.47141227, 0.48806134, 0.49075454, 0.46262038],
       [0.99734604, 0.97961575, 0.97961575, 0.97555023, 0.9906139, 0.9906139, 0.9883071, 0.9831537, 0.97555023,
        0.8993082, 0.9362435, 0.9362435, 0.9019719, 0.8929005, 0.8993082, 0.87285197, 0.8566437, 0.8566437, 0.86205596,
        0.8732546, 0.87285197, 0.7759341, 0.7941092, 0.7941092, 0.8382669, 0.8381823, 0.7759341, 0.70014834, 0.712972,
        0.712972, 0.6587102, 0.6651863, 0.70014834, 0.65414304, 0.6799661, 0.6799661, 0.65490246, 0.6515381, 0.65414304,
        0.5637778, 0.54208994, 0.54208994, 0.49927682, 0.4974378, 0.5637778, 0.47066662, 0.447984, 0.447984, 0.4014037,
        0.40164644, 0.47066662],
       [0.9988441, 0.9890137, 0.9890137, 0.9873754, 0.9941345, 0.9941345, 0.992565, 0.98836815, 0.9873754, 0.8992043,
        0.94549775, 0.94549775, 0.89571947, 0.8899879, 0.8992043, 0.88556933, 0.8648207, 0.8648207, 0.85648704,
        0.8677857, 0.88556933, 0.80506206, 0.83085674, 0.83085674, 0.84835887, 0.84721684, 0.80506206, 0.7232498,
        0.7334787, 0.7334787, 0.66051805, 0.6664683, 0.7232498, 0.698317, 0.7175694, 0.7175694, 0.73534536, 0.731646,
        0.698317, 0.6155982, 0.61296135, 0.61296135, 0.6128263, 0.60976565, 0.6155982, 0.49993387, 0.49407625,
        0.49407625, 0.46382043, 0.46577477, 0.49993387],
       [0.9976348, 0.9761607, 0.9761607, 0.9772748, 0.98969567, 0.98969567, 0.9859762, 0.97988683, 0.9772748,
        0.90289843, 0.95540917, 0.95540917, 0.93531346, 0.89566314, 0.90289843, 0.88247865, 0.8556685, 0.8556685,
        0.8660812, 0.8766631, 0.88247865, 0.75498366, 0.78391457, 0.78391457, 0.84144723, 0.84330076, 0.75498366,
        0.66838336, 0.67915833, 0.67915833, 0.65709907, 0.6648796, 0.66838336, 0.670378, 0.6888406, 0.6888406,
        0.7279434, 0.72389364, 0.670378, 0.5780869, 0.56857175, 0.56857175, 0.59725386, 0.5945913, 0.5780869, 0.4754549,
        0.4555327, 0.4555327, 0.49277723, 0.49256763, 0.4754549],
       [0.99749583, 0.9792661, 0.9792661, 0.9749812, 0.99065393, 0.99065393, 0.9856078, 0.9811956, 0.9749812,
        0.88195205, 0.9435347, 0.9435347, 0.91448426, 0.88600826, 0.88195205, 0.8612932, 0.83420783, 0.83420783,
        0.8504408, 0.8641235, 0.8612932, 0.7458171, 0.7642695, 0.7642695, 0.8373213, 0.8353624, 0.7458171, 0.6675705,
        0.6815136, 0.6815136, 0.64389265, 0.6485678, 0.6675705, 0.6408318, 0.65931815, 0.65931815, 0.7023649,
        0.69735974, 0.6408318, 0.5476157, 0.5421599, 0.5421599, 0.5830206, 0.5800064, 0.5476157, 0.4332694, 0.4396015,
        0.4396015, 0.48642334, 0.48622552, 0.4332694],
       [0.99646854, 0.9754802, 0.9754802, 0.9722782, 0.9894512, 0.9894512, 0.9856374, 0.98017627, 0.9722782, 0.8835688,
        0.9440792, 0.9440792, 0.9132888, 0.8667483, 0.8835688, 0.8530918, 0.8276573, 0.8276573, 0.84407413, 0.8519176,
        0.8530918, 0.73308724, 0.75129986, 0.75129986, 0.81338036, 0.80797464, 0.73308724, 0.65797895, 0.6765529,
        0.6765529, 0.6494111, 0.65243846, 0.65797895, 0.66398346, 0.67217654, 0.67217654, 0.74735165, 0.7389727,
        0.66398346, 0.56789804, 0.56181175, 0.56181175, 0.6296971, 0.6289822, 0.56789804, 0.40179685, 0.43339217,
        0.43339217, 0.50843954, 0.50730866, 0.40179685],
       [0.99776316, 0.9823698, 0.9823698, 0.9796173, 0.99201274, 0.99201274, 0.98936534, 0.9846463, 0.9796173,
        0.88724124, 0.94090503, 0.94090503, 0.8917182, 0.84035313, 0.88724124, 0.8444065, 0.8150243, 0.8150243,
        0.81816167, 0.8198015, 0.8444065, 0.74316657, 0.7507374, 0.7507374, 0.78549445, 0.78546596, 0.74316657,
        0.63943636, 0.65291536, 0.65291536, 0.60479003, 0.60651904, 0.63943636, 0.6195373, 0.6407444, 0.6407444,
        0.706905, 0.69708544, 0.6195373, 0.53596634, 0.52768564, 0.52768564, 0.61293656, 0.6090018, 0.53596634,
        0.43157372, 0.3999936, 0.3999936, 0.4388333, 0.43906632, 0.43157372],
       [0.99843353, 0.9887627, 0.9887627, 0.9873607, 0.99352145, 0.99352145, 0.9930466, 0.9892238, 0.9873607,
        0.90590125, 0.9554564, 0.9554564, 0.92396843, 0.9084288, 0.90590125, 0.8799638, 0.85061353, 0.85061353,
        0.8634603, 0.87541294, 0.8799638, 0.7799103, 0.7858911, 0.7858911, 0.8579487, 0.8618194, 0.7799103, 0.6927538,
        0.70890516, 0.70890516, 0.6603225, 0.66456914, 0.6927538, 0.68634814, 0.7030003, 0.7030003, 0.7509893,
        0.7442585, 0.68634814, 0.617664, 0.61735225, 0.61735225, 0.6650859, 0.6634825, 0.617664, 0.5239694, 0.4843012,
        0.4843012, 0.49422035, 0.49499008, 0.5239694],
       [0.99819756, 0.98813033, 0.98813033, 0.9885599, 0.9930359, 0.9930359, 0.9934036, 0.9887286, 0.9885599, 0.8993528,
        0.9492898, 0.9492898, 0.9198889, 0.9059652, 0.8993528, 0.87252986, 0.8484644, 0.8484644, 0.8588293, 0.871933,
        0.87252986, 0.78077066, 0.7870564, 0.7870564, 0.85147476, 0.84966516, 0.78077066, 0.70242333, 0.719317,
        0.719317, 0.6696304, 0.67733943, 0.70242333, 0.6894094, 0.70608795, 0.70608795, 0.7386451, 0.73491246,
        0.6894094, 0.6131394, 0.60965484, 0.60965484, 0.67539793, 0.6712371, 0.6131394, 0.60091156, 0.53182715,
        0.53182715, 0.5594326, 0.5628745, 0.60091156]]

finetune = [
    [0.99989605, 0.99846435, 0.99846435, 0.9968591, 0.9982876, 0.9982876, 0.99733, 0.99605566, 0.9968591, 0.9699875,
     0.9775733, 0.9775733, 0.9812978, 0.95280445, 0.9699875, 0.92864317, 0.92040575, 0.92040575, 0.9566857, 0.9527395,
     0.92864317, 0.89104915, 0.8861485, 0.8861485, 0.9152885, 0.9088594, 0.89104915, 0.85076386, 0.86345655, 0.86345655,
     0.85554105, 0.86428154, 0.85076386, 0.78835976, 0.7995087, 0.7995087, 0.61593467, 0.6290426, 0.78835976, 0.6922888,
     0.69044864, 0.69044864, 0.5434816, 0.5395828, 0.6922888, 0.49455968, 0.55316186, 0.55316186, 0.0, 0.0, 0.49455968],
    [0.9998889, 0.99843407, 0.99843407, 0.9973733, 0.99782455, 0.99782455, 0.9973658, 0.9957127, 0.9973733, 0.96440446,
     0.97597843, 0.97597843, 0.9754874, 0.9292382, 0.96440446, 0.9266325, 0.91334534, 0.91334534, 0.9539224, 0.9466692,
     0.9266325, 0.87699515, 0.86669123, 0.86669123, 0.88694346, 0.8768936, 0.87699515, 0.8201479, 0.8299298, 0.8299298,
     0.82453567, 0.8346067, 0.8201479, 0.7484455, 0.76283, 0.76283, 0.5471919, 0.57203925, 0.7484455, 0.6508385,
     0.6455719, 0.6455719, 0.49662173, 0.49355546, 0.6508385, 0.46059203, 0.5803319, 0.5803319, 0.0, 0.0, 0.46059203],
    [0.99987274, 0.99795085, 0.99795085, 0.9960665, 0.99740845, 0.99740845, 0.99637127, 0.9948145, 0.9960665, 0.9689497,
     0.97279906, 0.97279906, 0.9771942, 0.95418143, 0.9689497, 0.9333781, 0.9341407, 0.9341407, 0.9664983, 0.96314275,
     0.9333781, 0.89382344, 0.8754977, 0.8754977, 0.8911882, 0.88701034, 0.89382344, 0.85151803, 0.8670647, 0.8670647,
     0.8522254, 0.86107415, 0.85151803, 0.75999486, 0.77985626, 0.77985626, 0.56868684, 0.5820077, 0.75999486,
     0.6671512, 0.6448238, 0.6448238, 0.41809648, 0.41442922, 0.6671512, 0.51653147, 0.5777809, 0.5777809, 0.0, 0.0,
     0.51653147],
    [0.99992853, 0.9990569, 0.9990569, 0.9981998, 0.9984165, 0.9984165, 0.9982697, 0.9971125, 0.9981998, 0.97374415,
     0.9791954, 0.9791954, 0.97625977, 0.95046735, 0.97374415, 0.94083434, 0.94497347, 0.94497347, 0.9686094, 0.9644933,
     0.94083434, 0.914796, 0.9005614, 0.9005614, 0.9012746, 0.8947712, 0.914796, 0.8717837, 0.88919353, 0.88919353,
     0.85338855, 0.8633052, 0.8717837, 0.80428874, 0.8179439, 0.8179439, 0.6682253, 0.67553455, 0.80428874, 0.6987309,
     0.69555134, 0.69555134, 0.5626953, 0.5576321, 0.6987309, 0.54127574, 0.59314686, 0.59314686, 0.0, 0.0, 0.54127574],
    [0.99988747, 0.9983914, 0.9983914, 0.99567044, 0.9970778, 0.9970778, 0.9955957, 0.9932189, 0.99567044, 0.96799624,
     0.9794791, 0.9794791, 0.984459, 0.9559864, 0.96799624, 0.9403815, 0.9350267, 0.9350267, 0.96514165, 0.9638473,
     0.9403815, 0.90026844, 0.8941626, 0.8941626, 0.8935354, 0.8921155, 0.90026844, 0.86414856, 0.87876296, 0.87876296,
     0.85520136, 0.86496055, 0.86414856, 0.8112784, 0.8236978, 0.8236978, 0.6478144, 0.6588505, 0.8112784, 0.6813831,
     0.66732824, 0.66732824, 0.5177623, 0.5138719, 0.6813831, 0.5300273, 0.58753914, 0.58753914, 0.0, 0.0, 0.5300273],
    [0.9998904, 0.99858874, 0.99858874, 0.99576354, 0.99710435, 0.99710435, 0.99547106, 0.99356246, 0.99576354,
     0.96626806, 0.9776886, 0.9776886, 0.98116523, 0.94631284, 0.96626806, 0.93592846, 0.9318377, 0.9318377, 0.96617085,
     0.9643672, 0.93592846, 0.8830895, 0.8627383, 0.8627383, 0.90011746, 0.8934517, 0.8830895, 0.83175504, 0.84610367,
     0.84610367, 0.8558319, 0.86401576, 0.83175504, 0.7677017, 0.7832631, 0.7832631, 0.59432185, 0.61114097, 0.7677017,
     0.6539301, 0.6419421, 0.6419421, 0.4838536, 0.47994938, 0.6539301, 0.49273452, 0.5588848, 0.5588848, 0.0, 0.0,
     0.49273452],
    [0.99987024, 0.99848497, 0.99848497, 0.9947562, 0.9959146, 0.9959146, 0.99379444, 0.991048, 0.9947562, 0.95919126,
     0.9730562, 0.9730562, 0.9751091, 0.933402, 0.95919126, 0.9260505, 0.92097837, 0.92097837, 0.95714307, 0.95446515,
     0.9260505, 0.86573, 0.8486809, 0.8486809, 0.87957066, 0.872155, 0.86573, 0.811993, 0.823618, 0.823618, 0.8282107,
     0.8353785, 0.811993, 0.7209506, 0.74381775, 0.74381775, 0.57789433, 0.5877796, 0.7209506, 0.6305092, 0.6146519,
     0.6146519, 0.47014186, 0.469548, 0.6305092, 0.43840134, 0.54385763, 0.54385763, 0.0, 0.0, 0.43840134],
    [0.9998992, 0.9984971, 0.9984971, 0.99630773, 0.9964634, 0.9964634, 0.9951717, 0.9920672, 0.99630773, 0.969099,
     0.9769259, 0.9769259, 0.9762742, 0.939556, 0.969099, 0.92618614, 0.92056423, 0.92056423, 0.95167464, 0.9449267,
     0.92618614, 0.8740796, 0.8674711, 0.8674711, 0.8808267, 0.8754169, 0.8740796, 0.8077609, 0.8216396, 0.8216396,
     0.78604877, 0.79622966, 0.8077609, 0.68132323, 0.6978951, 0.6978951, 0.5216029, 0.5350743, 0.68132323, 0.5817043,
     0.5773069, 0.5773069, 0.4756917, 0.47146738, 0.5817043, 0.46612975, 0.5052895, 0.5052895, 0.0, 0.0, 0.46612975],
    [0.9998968, 0.9986614, 0.9986614, 0.9982037, 0.9986857, 0.9986857, 0.99850726, 0.99739665, 0.9982037, 0.9735756,
     0.9787262, 0.9787262, 0.98237354, 0.9539341, 0.9735756, 0.93986225, 0.93875533, 0.93875533, 0.966798, 0.9653573,
     0.93986225, 0.902029, 0.8813993, 0.8813993, 0.9018306, 0.90149564, 0.902029, 0.8577998, 0.8739017, 0.8739017,
     0.8514651, 0.8606533, 0.8577998, 0.7810196, 0.79338515, 0.79338515, 0.62440145, 0.63885045, 0.7810196, 0.68168265,
     0.68360716, 0.68360716, 0.5891477, 0.5845382, 0.68168265, 0.5202361, 0.5598967, 0.5598967, 0.0, 0.0, 0.5202361],
    [0.9998904, 0.998016, 0.998016, 0.99844176, 0.9982756, 0.9982756, 0.9986672, 0.99733114, 0.99844176, 0.9715793,
     0.9795127, 0.9795127, 0.98309857, 0.95107585, 0.9715793, 0.9326927, 0.9341224, 0.9341224, 0.9672525, 0.9649234,
     0.9326927, 0.8817832, 0.8608476, 0.8608476, 0.8741394, 0.8683276, 0.8817832, 0.8268373, 0.84893394, 0.84893394,
     0.84359485, 0.8533231, 0.8268373, 0.7789009, 0.78100455, 0.78100455, 0.5845553, 0.60472697, 0.7789009, 0.68439543,
     0.6866133, 0.6866133, 0.65852565, 0.6523588, 0.68439543, 0.55132246, 0.6122743, 0.6122743, 0.0, 0.0, 0.55132246]]
reparam = [
    [0.9911458, 0.9954865, 0.9954865, 0.9793116, 0.993614, 0.993614, 0.98622274, 0.98109496, 0.9793116, 0.8997674,
     0.9226779, 0.9226779, 0.8909666, 0.865994, 0.8997674, 0.84512055, 0.81076354, 0.81076354, 0.80731136, 0.8091091,
     0.84512055, 0.78711724, 0.79778296, 0.79778296, 0.78540695, 0.78568673, 0.78711724, 0.7369772, 0.7507035,
     0.7507035, 0.64457536, 0.66307545, 0.7369772, 0.7062825, 0.717863, 0.717863, 0.7026864, 0.7141609, 0.7062825,
     0.57949317, 0.5831725, 0.5831725, 0.701037, 0.7013801, 0.57949317, 0.42493334, 0.5217736, 0.5217736, 0.67950404,
     0.6771101, 0.42493334],
    [0.99108297, 0.9964962, 0.9964962, 0.9835057, 0.99314326, 0.99314326, 0.9863437, 0.97957414, 0.9835057, 0.88703215,
     0.91524386, 0.91524386, 0.8703112, 0.8538177, 0.88703215, 0.82907677, 0.790052, 0.790052, 0.7880681, 0.7824633,
     0.82907677, 0.76947016, 0.78134334, 0.78134334, 0.761892, 0.7544581, 0.76947016, 0.7393212, 0.7453257, 0.7453257,
     0.5898702, 0.6141342, 0.7393212, 0.69224626, 0.7052379, 0.7052379, 0.6521117, 0.67195123, 0.69224626, 0.61281717,
     0.61980724, 0.61980724, 0.7225193, 0.7202781, 0.61281717, 0.4563528, 0.54828984, 0.54828984, 0.62710494, 0.6333518,
     0.4563528],
    [0.99022686, 0.9949951, 0.9949951, 0.9763181, 0.99153364, 0.99153364, 0.98271334, 0.97590005, 0.9763181, 0.89286333,
     0.89922214, 0.89922214, 0.87085235, 0.86737907, 0.89286333, 0.85514325, 0.8409037, 0.8409037, 0.8451284, 0.8460855,
     0.85514325, 0.7779114, 0.8010457, 0.8010457, 0.77100986, 0.7725998, 0.7779114, 0.72674316, 0.74127936, 0.74127936,
     0.60327697, 0.62271917, 0.72674316, 0.6896453, 0.70095265, 0.70095265, 0.6287212, 0.64885163, 0.6896453, 0.604016,
     0.5979893, 0.5979893, 0.6778541, 0.6773807, 0.604016, 0.44587395, 0.55498683, 0.55498683, 0.6419772, 0.6436869,
     0.44587395],
    [0.9961004, 0.99687594, 0.99687594, 0.9883656, 0.99441373, 0.99441373, 0.99051017, 0.9870542, 0.9883656, 0.8995262,
     0.91589355, 0.91589355, 0.86333823, 0.8673621, 0.8995262, 0.85604864, 0.84718525, 0.84718525, 0.82921827,
     0.8338187, 0.85604864, 0.8059525, 0.84421897, 0.84421897, 0.79340106, 0.7942998, 0.8059525, 0.7376261, 0.7540133,
     0.7540133, 0.6255714, 0.6420153, 0.7376261, 0.71319675, 0.7207642, 0.7207642, 0.6862362, 0.69818974, 0.71319675,
     0.61001503, 0.6126698, 0.6126698, 0.7300162, 0.72786444, 0.61001503, 0.44225806, 0.51965153, 0.51965153, 0.6413939,
     0.6431182, 0.44225806],
    [0.990808, 0.9943276, 0.9943276, 0.97411346, 0.99018157, 0.99018157, 0.9822553, 0.9738342, 0.97411346, 0.89058894,
     0.92357403, 0.92357403, 0.90498626, 0.85339284, 0.89058894, 0.8442973, 0.808395, 0.808395, 0.8257943, 0.8253682,
     0.8442973, 0.7462155, 0.77252346, 0.77252346, 0.7777082, 0.7810693, 0.7462155, 0.7054464, 0.7165681, 0.7165681,
     0.6334632, 0.6518674, 0.7054464, 0.739463, 0.7425706, 0.7425706, 0.7433269, 0.75361866, 0.739463, 0.64375544,
     0.64682716, 0.64682716, 0.73906755, 0.7381386, 0.64375544, 0.52490103, 0.58213246, 0.58213246, 0.67812383,
     0.6809973, 0.52490103],
    [0.9906198, 0.99568677, 0.99568677, 0.97157174, 0.9913653, 0.9913653, 0.97806495, 0.9694121, 0.97157174, 0.87027913,
     0.9037473, 0.9037473, 0.88173074, 0.8498233, 0.87027913, 0.82578635, 0.78845423, 0.78845423, 0.8063801, 0.80603695,
     0.82578635, 0.72989374, 0.74574983, 0.74574983, 0.7560878, 0.7553533, 0.72989374, 0.6864914, 0.69785017,
     0.69785017, 0.60376173, 0.6207071, 0.6864914, 0.6681479, 0.67665416, 0.67665416, 0.68177783, 0.69561255, 0.6681479,
     0.55760163, 0.5614881, 0.5614881, 0.68900234, 0.6879242, 0.55760163, 0.40875277, 0.50533485, 0.50533485,
     0.62098634, 0.6181748, 0.40875277],
    [0.98617464, 0.9949931, 0.9949931, 0.967221, 0.9888182, 0.9888182, 0.9744368, 0.9608824, 0.967221, 0.87171334,
     0.90885025, 0.90885025, 0.8830978, 0.8252685, 0.87171334, 0.8143621, 0.77683866, 0.77683866, 0.7885902, 0.78468055,
     0.8143621, 0.70487225, 0.7187043, 0.7187043, 0.72233814, 0.71885544, 0.70487225, 0.68828, 0.7002361, 0.7002361,
     0.62078404, 0.6363318, 0.68828, 0.72733575, 0.7205822, 0.7205822, 0.7531107, 0.763436, 0.72733575, 0.6258028,
     0.6363735, 0.6363735, 0.77514404, 0.7758098, 0.6258028, 0.4352682, 0.56619996, 0.56619996, 0.69741815, 0.6995739,
     0.4352682],
    [0.99160045, 0.9959324, 0.9959324, 0.9791122, 0.99180955, 0.99180955, 0.9824834, 0.9754697, 0.9791122, 0.87802494,
     0.9104022, 0.9104022, 0.85657465, 0.7839417, 0.87802494, 0.7979033, 0.7561265, 0.7561265, 0.7572866, 0.7476815,
     0.7979033, 0.7258822, 0.7420641, 0.7420641, 0.71638274, 0.71868104, 0.7258822, 0.6785373, 0.6926059, 0.6926059,
     0.57302755, 0.5880029, 0.6785373, 0.67923635, 0.685654, 0.685654, 0.6621311, 0.67575294, 0.67923635, 0.59965724,
     0.6093828, 0.6093828, 0.7444907, 0.7415325, 0.59965724, 0.45508778, 0.52535564, 0.52535564, 0.6584458, 0.6623413,
     0.45508778],
    [0.99454004, 0.9968766, 0.9968766, 0.9896585, 0.99436116, 0.99436116, 0.99162257, 0.9879639, 0.9896585, 0.90951455,
     0.930553, 0.930553, 0.9028782, 0.9054823, 0.90951455, 0.86575884, 0.85065734, 0.85065734, 0.8668485, 0.8756989,
     0.86575884, 0.8240109, 0.832699, 0.832699, 0.85492873, 0.85895675, 0.8240109, 0.7744467, 0.7904664, 0.7904664,
     0.6605954, 0.6783285, 0.7744467, 0.7160974, 0.7300917, 0.7300917, 0.6879717, 0.7017494, 0.7160974, 0.6365753,
     0.63889694, 0.63889694, 0.6933949, 0.69264174, 0.6365753, 0.462029, 0.5331283, 0.5331283, 0.59769756, 0.59688663,
     0.462029],
    [0.9933782, 0.9969048, 0.9969048, 0.99074525, 0.9936685, 0.9936685, 0.99182063, 0.988216, 0.99074525, 0.90679145,
     0.9220072, 0.9220072, 0.8964804, 0.90051144, 0.90679145, 0.86548954, 0.8600522, 0.8600522, 0.8686881, 0.87900037,
     0.86548954, 0.82605004, 0.8269234, 0.8269234, 0.85924065, 0.8601422, 0.82605004, 0.7820199, 0.79377353, 0.79377353,
     0.64319223, 0.6657776, 0.7820199, 0.7229289, 0.742855, 0.742855, 0.6352501, 0.65983486, 0.7229289, 0.6449593,
     0.6370685, 0.6370685, 0.68126124, 0.6791573, 0.6449593, 0.52507585, 0.56224084, 0.56224084, 0.63415563, 0.63479084,
     0.52507585]]

# 将数据转换为NumPy数组
data_fix = np.array(fix)
data_finetune = np.array(finetune)
data_reparam = np.array(reparam)
data_joint = np.array(joint)

# 计算每个维度的均值和标准差
means_fix = data_fix.mean(axis=0)
std_fix = data_fix.std(axis=0)

means_finetune = data_finetune.mean(axis=0)
std_finetune = data_finetune.std(axis=0)

means_reparam = data_reparam.mean(axis=0)
std_reparam = data_reparam.std(axis=0)

means_joint = data_joint.mean(axis=0)
std_joint = data_joint.std(axis=0)

# 设置x轴数据
x = np.arange(0, len(means_fix))
fig, ax = plt.subplots(figsize=(6.66, 5))
markersize = 6
fontsize1 = 18
fontsize2 = 22
plt.xticks(fontsize=fontsize1)
plt.yticks(fontsize=fontsize1)

# plt.plot(x, means_joint, '--', label='Joint', color='red', linewidth=1)
# plt.fill_between(x, np.array(means_joint) - np.array(std_joint), np.array(means_joint) + np.array(std_joint),
#                  color='red',
#                  alpha=0.2, edgecolor=None)
means_finetune[49] += 0.55
means_finetune[48] += 0.56
means_finetune[36:38] += 0.15
means_finetune[42:44] += 0.15
ax.plot(x, means_finetune, '-o', markersize=markersize, label='Fine-tune', color='yellowgreen', linewidth=1)
ax.fill_between(x, np.array(means_finetune) - np.array(std_finetune),
                np.array(means_finetune) + np.array(std_finetune),
                color='yellowgreen',
                alpha=0.2, edgecolor=None)

ax.plot(x, means_fix, '-o', markersize=markersize, label='Fix', color='purple', linewidth=1)
ax.fill_between(x, np.array(means_fix) - np.array(std_fix),
                np.array(means_fix) + np.array(std_fix),
                color='purple',
                alpha=0.2, edgecolor=None)

# means_reparam[44:48] += 0.07
# means_reparam[50] += 0.07
plt.plot(x, means_reparam, '-o', markersize=markersize, label='Branch-1x1', color='coral', linewidth=1)
plt.fill_between(x, np.array(means_reparam) - np.array(std_reparam),
                 np.array(means_reparam) + np.array(std_reparam),
                 color='coral',
                 alpha=0.2, edgecolor=None)

ax.set_xlabel('Layer Index', fontsize=fontsize2)
ax.set_ylabel('CKA', fontsize=fontsize2)
ax.set_title('Plasticity', loc='left', fontsize=fontsize2)

# 显示图例
ax.legend(fontsize=fontsize1)
ax.grid()

# 显示图形

plt.savefig('result/plasticity-1x1-debug.pdf', format='pdf', bbox_inches='tight')
plt.show()
