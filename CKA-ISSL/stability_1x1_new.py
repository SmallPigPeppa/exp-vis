import numpy as np
import matplotlib.pyplot as plt

joint = [[1.0] * 9] * 9

fix = [[1.0] * 51] * 51

finetune = [[0.9896086, 0.98605525, 0.98605525, 0.98186094, 0.99145526, 0.99145526, 0.9827201, 0.97263527, 0.98186094,
             0.9134801, 0.869532, 0.869532, 0.8271236, 0.832679, 0.9134801, 0.86215156, 0.85852706, 0.85852706,
             0.8113274, 0.8444625, 0.86215156, 0.8225181, 0.78871626, 0.78871626, 0.8129349, 0.7937391, 0.8225181,
             0.7189754, 0.70828915, 0.70828915, 0.5693673, 0.57169473, 0.7189754, 0.56042224, 0.5640838, 0.5640838,
             0.3786373, 0.39978534, 0.56042224, 0.46359625, 0.47357786, 0.47357786, 0.3528911, 0.35919684, 0.46359625,
             0.4162151, 0.4571702, 0.4571702, 0.42371032, 0.43570757, 0.4162151],
            [0.99370104, 0.9894925, 0.9894925, 0.98467684, 0.9924869, 0.9924869, 0.9856953, 0.9783506, 0.98467684,
             0.91303873, 0.8669256, 0.8669256, 0.82144606, 0.83463854, 0.91303873, 0.8692474, 0.8715041, 0.8715041,
             0.83718526, 0.85922486, 0.8692474, 0.81689245, 0.7890664, 0.7890664, 0.8336936, 0.8170433, 0.81689245,
             0.69701374, 0.68671757, 0.68671757, 0.569529, 0.56955814, 0.69701374, 0.5523737, 0.569296, 0.569296,
             0.46644646, 0.48570403, 0.5523737, 0.43885085, 0.4687714, 0.4687714, 0.383143, 0.3928187, 0.43885085,
             0.3965918, 0.42899814, 0.42899814, 0.48999098, 0.49556333, 0.3965918],
            [0.9894057, 0.99196136, 0.99196136, 0.9824379, 0.9875231, 0.9875231, 0.98129207, 0.9718774, 0.9824379,
             0.919185, 0.8739688, 0.8739688, 0.82264405, 0.83251005, 0.919185, 0.87538815, 0.87714773, 0.87714773,
             0.8384001, 0.86647654, 0.87538815, 0.81979775, 0.7845354, 0.7845354, 0.79165316, 0.7700845, 0.81979775,
             0.713085, 0.6966357, 0.6966357, 0.55738235, 0.5555908, 0.713085, 0.5846126, 0.6037435, 0.6037435,
             0.42189485, 0.44687268, 0.5846126, 0.47903144, 0.48216704, 0.48216704, 0.32124937, 0.33760706, 0.47903144,
             0.40495515, 0.45100826, 0.45100826, 0.45073166, 0.46082878, 0.40495515],
            [0.988523, 0.9904736, 0.9904736, 0.9814211, 0.9917975, 0.9917975, 0.980664, 0.97065, 0.9814211, 0.8883547,
             0.8283501, 0.8283501, 0.77918416, 0.78769624, 0.8883547, 0.8427195, 0.84505016, 0.84505016, 0.80498177,
             0.83511215, 0.8427195, 0.7966487, 0.7634323, 0.7634323, 0.78769857, 0.76699895, 0.7966487, 0.6691379,
             0.6557192, 0.6557192, 0.5016203, 0.49962798, 0.6691379, 0.50445503, 0.5163282, 0.5163282, 0.28817847,
             0.31372148, 0.50445503, 0.4095924, 0.42292574, 0.42292574, 0.28428766, 0.29159573, 0.4095924, 0.3609818,
             0.39136118, 0.39136118, 0.37905613, 0.39265382, 0.3609818],
            [0.9883938, 0.9891329, 0.9891329, 0.98132586, 0.99221337, 0.99221337, 0.9812321, 0.97034544, 0.98132586,
             0.9034019, 0.82519466, 0.82519466, 0.7588206, 0.7712636, 0.9034019, 0.8437813, 0.845599, 0.845599,
             0.79932976, 0.83262074, 0.8437813, 0.8132441, 0.7827679, 0.7827679, 0.8229205, 0.7998882, 0.8132441,
             0.7194475, 0.6897823, 0.6897823, 0.56582975, 0.5615122, 0.7194475, 0.56642383, 0.5802239, 0.5802239,
             0.37303248, 0.39673126, 0.56642383, 0.47551206, 0.47004429, 0.47004429, 0.29686803, 0.3068759, 0.47551206,
             0.39745748, 0.45384791, 0.45384791, 0.35436073, 0.3668162, 0.39745748],
            [0.99104095, 0.9861731, 0.9861731, 0.9838241, 0.9910148, 0.9910148, 0.9858663, 0.97813624, 0.9838241,
             0.90946007, 0.87102675, 0.87102675, 0.84598583, 0.85238177, 0.90946007, 0.8585235, 0.86062115, 0.86062115,
             0.8090064, 0.8407451, 0.8585235, 0.8214954, 0.78528327, 0.78528327, 0.7948819, 0.77562416, 0.8214954,
             0.71812433, 0.70884395, 0.70884395, 0.58843064, 0.59609216, 0.71812433, 0.58779603, 0.6055292, 0.6055292,
             0.48648852, 0.5069541, 0.58779603, 0.487038, 0.5185563, 0.5185563, 0.39728737, 0.40636155, 0.487038,
             0.43712273, 0.45753995, 0.45753995, 0.43892598, 0.4509527, 0.43712273],
            [0.9923839, 0.99055725, 0.99055725, 0.9875515, 0.99317527, 0.99317527, 0.9840414, 0.9733019, 0.9875515,
             0.922445, 0.87170076, 0.87170076, 0.81936765, 0.8344443, 0.922445, 0.87086105, 0.8722578, 0.8722578,
             0.8374737, 0.86149955, 0.87086105, 0.833729, 0.79508555, 0.79508555, 0.8017799, 0.78505534, 0.833729,
             0.7386546, 0.7225505, 0.7225505, 0.5970021, 0.60008615, 0.7386546, 0.59808016, 0.60929626, 0.60929626,
             0.43969536, 0.46592432, 0.59808016, 0.49506778, 0.5122982, 0.5122982, 0.36993167, 0.38103834, 0.49506778,
             0.38021243, 0.449721, 0.449721, 0.48390153, 0.4896821, 0.38021243],
            [0.9892357, 0.99077666, 0.99077666, 0.9787128, 0.98604506, 0.98604506, 0.97578955, 0.96632165, 0.9787128,
             0.90583885, 0.86018544, 0.86018544, 0.8045859, 0.81521565, 0.90583885, 0.8322293, 0.84050566, 0.84050566,
             0.7924302, 0.8275773, 0.8322293, 0.7709715, 0.74218565, 0.74218565, 0.7311492, 0.71369, 0.7709715,
             0.6321844, 0.614705, 0.614705, 0.49750727, 0.4937062, 0.6321844, 0.50401545, 0.506523, 0.506523,
             0.34919345, 0.36972216, 0.50401545, 0.45099658, 0.46434942, 0.46434942, 0.3756146, 0.38690495, 0.45099658,
             0.43288904, 0.4516646, 0.4516646, 0.4034108, 0.41377378, 0.43288904],
            [0.991069, 0.9920443, 0.9920443, 0.98407376, 0.9904436, 0.9904436, 0.97944576, 0.9693678, 0.98407376,
             0.9206688, 0.87261593, 0.87261593, 0.8044456, 0.8164793, 0.9206688, 0.8786139, 0.8795355, 0.8795355,
             0.84980905, 0.8728269, 0.8786139, 0.8383734, 0.81197387, 0.81197387, 0.82430154, 0.81061184, 0.8383734,
             0.73547924, 0.72273886, 0.72273886, 0.57956, 0.5774795, 0.73547924, 0.57750726, 0.5780784, 0.5780784,
             0.35420647, 0.37893352, 0.57750726, 0.500178, 0.51923674, 0.51923674, 0.38473076, 0.39462835, 0.500178,
             0.43244383, 0.44461736, 0.44461736, 0.36299714, 0.37913117, 0.43244383],
            [0.99054027, 0.9923944, 0.9923944, 0.9855235, 0.9903293, 0.9903293, 0.9803224, 0.967917, 0.9855235,
             0.8988391, 0.8355706, 0.8355706, 0.76371884, 0.7797079, 0.8988391, 0.85733354, 0.8659481, 0.8659481,
             0.8418652, 0.8660767, 0.85733354, 0.8035801, 0.77932316, 0.77932316, 0.8012894, 0.782889, 0.8035801,
             0.68765396, 0.6782372, 0.6782372, 0.54173917, 0.54311866, 0.68765396, 0.5319684, 0.5372217, 0.5372217,
             0.36507335, 0.38550836, 0.5319684, 0.46388507, 0.48422262, 0.48422262, 0.41474336, 0.4231319, 0.46388507,
             0.43470797, 0.44493067, 0.44493067, 0.42670873, 0.43730444, 0.43470797]]
reparam = [
    [1.0, 0.99947387, 0.99947387, 0.99865574, 0.9955072, 0.9955072, 0.9955726, 0.9898514, 0.99865574, 0.9962816,
     0.99372596, 0.99372596, 0.9935273, 0.9947307, 0.9962816, 0.99500346, 0.99316853, 0.99316853, 0.9933641, 0.99300647,
     0.99500346, 0.99245054, 0.9940698, 0.9940698, 0.9953634, 0.99542713, 0.99245054, 0.9874637, 0.9880233, 0.9880233,
     0.9844272, 0.9853884, 0.9874637, 0.98188126, 0.9813943, 0.9813943, 0.98130053, 0.98012173, 0.98188126, 0.97383463,
     0.97394955, 0.97394955, 0.9720642, 0.9721645, 0.97383463, 0.95391876, 0.9712852, 0.9712852, 0.9597068, 0.96070594,
     0.95391876],
    [1.0, 0.99948764, 0.99948764, 0.9985906, 0.9968545, 0.9968545, 0.99693835, 0.99339104, 0.9985906, 0.9962857,
     0.9946061, 0.9946061, 0.9952222, 0.99435997, 0.9962857, 0.99483097, 0.9929227, 0.9929227, 0.9942191, 0.9940141,
     0.99483097, 0.9911718, 0.99391466, 0.99391466, 0.9952527, 0.99514306, 0.9911718, 0.9885209, 0.98848367, 0.98848367,
     0.9866378, 0.98733234, 0.9885209, 0.98400015, 0.9836003, 0.9836003, 0.9863286, 0.9843468, 0.98400015, 0.9792614,
     0.9786715, 0.9786715, 0.97825354, 0.9781761, 0.9792614, 0.96283394, 0.97385186, 0.97385186, 0.9639099, 0.9644062,
     0.96283394],
    [1.0, 0.9992484, 0.9992484, 0.9986184, 0.99471873, 0.99471873, 0.9938051, 0.98417723, 0.9986184, 0.99597406,
     0.992795, 0.992795, 0.99289656, 0.9942273, 0.99597406, 0.99377054, 0.99095845, 0.99095845, 0.99144024, 0.9915157,
     0.99377054, 0.98781824, 0.99327856, 0.99327856, 0.994722, 0.9946927, 0.98781824, 0.98181564, 0.98214966,
     0.98214966, 0.9773399, 0.97880167, 0.98181564, 0.9779297, 0.9780488, 0.9780488, 0.98384416, 0.9818866, 0.9779297,
     0.9736906, 0.9724039, 0.9724039, 0.9706661, 0.9703747, 0.9736906, 0.9448474, 0.9640136, 0.9640136, 0.9595007,
     0.9591432, 0.9448474],
    [1.0, 0.99918574, 0.99918574, 0.9989908, 0.994637, 0.994637, 0.9945113, 0.985779, 0.9989908, 0.9966711, 0.99436086,
     0.99436086, 0.9947293, 0.99396116, 0.9966711, 0.99471873, 0.99323916, 0.99323916, 0.99411637, 0.9942183,
     0.99471873, 0.99002373, 0.994234, 0.994234, 0.9939529, 0.99381816, 0.99002373, 0.9864044, 0.9868167, 0.9868167,
     0.9826753, 0.9837479, 0.9864044, 0.98106533, 0.98166335, 0.98166335, 0.9834854, 0.9817313, 0.98106533, 0.98016703,
     0.97995573, 0.97995573, 0.97927785, 0.9790365, 0.98016703, 0.96786, 0.97633487, 0.97633487, 0.9718128, 0.97201943,
     0.96786],
    [1.0, 0.99918604, 0.99918604, 0.9987257, 0.9945413, 0.9945413, 0.99414265, 0.9859223, 0.9987257, 0.99604696,
     0.99265075, 0.99265075, 0.9920182, 0.9933157, 0.99604696, 0.99394846, 0.9920673, 0.9920673, 0.99231666, 0.99257326,
     0.99394846, 0.9894194, 0.99294204, 0.99294204, 0.99337345, 0.9933874, 0.9894194, 0.9845926, 0.9853655, 0.9853655,
     0.9803523, 0.9814312, 0.9845926, 0.9780398, 0.9799634, 0.9799634, 0.97855604, 0.9769486, 0.9780398, 0.9682053,
     0.96569633, 0.96569633, 0.9618934, 0.96226984, 0.9682053, 0.9523866, 0.95841855, 0.95841855, 0.9494908, 0.94992507,
     0.9523866],
    [1.0, 0.9995815, 0.9995815, 0.99864894, 0.9964776, 0.9964776, 0.996439, 0.99217343, 0.99864894, 0.99683934,
     0.9944905, 0.9944905, 0.9941825, 0.9954275, 0.99683934, 0.9955233, 0.99393713, 0.99393713, 0.9941959, 0.9938996,
     0.9955233, 0.9923874, 0.9944903, 0.9944903, 0.9966352, 0.9966567, 0.9923874, 0.9878825, 0.9887979, 0.9887979,
     0.98593843, 0.9868897, 0.9878825, 0.98307717, 0.9817024, 0.9817024, 0.9851338, 0.9833893, 0.98307717, 0.9671903,
     0.96814525, 0.96814525, 0.96661556, 0.966576, 0.9671903, 0.9441534, 0.9619924, 0.9619924, 0.9573135, 0.95836824,
     0.9441534],
    [1.0, 0.999499, 0.999499, 0.99893796, 0.9969771, 0.9969771, 0.9968162, 0.9913556, 0.99893796, 0.9969145, 0.9948055,
     0.9948055, 0.9947868, 0.9953607, 0.9969145, 0.99547005, 0.9932983, 0.9932983, 0.99327254, 0.99323153, 0.99547005,
     0.9922861, 0.9947287, 0.9947287, 0.9963513, 0.9961866, 0.9922861, 0.9879508, 0.98886335, 0.98886335, 0.98456436,
     0.9849433, 0.9879508, 0.9830265, 0.98328614, 0.98328614, 0.984717, 0.98305947, 0.9830265, 0.9748791, 0.9744231,
     0.9744231, 0.9717407, 0.97228897, 0.9748791, 0.95060384, 0.9664941, 0.9664941, 0.9565391, 0.957559, 0.95060384],
    [1.0, 0.99913377, 0.99913377, 0.99876136, 0.9943662, 0.9943662, 0.99349856, 0.9828579, 0.99876136, 0.9960562,
     0.992736, 0.992736, 0.9927929, 0.9950913, 0.9960562, 0.9937556, 0.99161905, 0.99161905, 0.9928648, 0.99280345,
     0.9937556, 0.9874936, 0.9924863, 0.9924863, 0.9945565, 0.9946733, 0.9874936, 0.9828727, 0.9832427, 0.9832427,
     0.9774944, 0.9788967, 0.9828727, 0.98103046, 0.9796567, 0.9796567, 0.9832158, 0.980782, 0.98103046, 0.9775058,
     0.9771205, 0.9771205, 0.97620654, 0.97648436, 0.9775058, 0.96728486, 0.97670543, 0.97670543, 0.9705091, 0.97059596,
     0.96728486],
    [1.0, 0.99929637, 0.99929637, 0.99887556, 0.9961447, 0.9961447, 0.9950254, 0.9861195, 0.99887556, 0.99619913,
     0.9938367, 0.9938367, 0.993362, 0.9937321, 0.99619913, 0.99448544, 0.9915678, 0.9915678, 0.9921578, 0.9918616,
     0.99448544, 0.98953676, 0.9939575, 0.9939575, 0.99338555, 0.9933266, 0.98953676, 0.9840891, 0.98495424, 0.98495424,
     0.9816512, 0.98251355, 0.9840891, 0.97961026, 0.980117, 0.980117, 0.9845926, 0.98278, 0.97961026, 0.9744735,
     0.97288054, 0.97288054, 0.97174305, 0.9713494, 0.9744735, 0.95775867, 0.9696328, 0.9696328, 0.9658102, 0.9667909,
     0.95775867],
    [1.0, 0.9990435, 0.9990435, 0.9986064, 0.99567497, 0.99567497, 0.99501085, 0.98735493, 0.9986064, 0.9963356,
     0.99316585, 0.99316585, 0.99399024, 0.9943921, 0.9963356, 0.99371374, 0.99188626, 0.99188626, 0.9934012, 0.9933784,
     0.99371374, 0.98832875, 0.99275494, 0.99275494, 0.9942262, 0.9940847, 0.98832875, 0.9848561, 0.9849905, 0.9849905,
     0.9827899, 0.9836198, 0.9848561, 0.9816745, 0.98122156, 0.98122156, 0.9846867, 0.9827307, 0.9816745, 0.98114944,
     0.9802271, 0.9802271, 0.9785852, 0.97858834, 0.98114944, 0.96695113, 0.9758325, 0.9758325, 0.9701872, 0.971088,
     0.96695113]]

reparam = [
    [0.9992768, 0.9928492, 0.9928492, 0.9925028, 0.9946644, 0.9946644, 0.9936869, 0.9871662, 0.9925028, 0.9866072,
     0.98709536, 0.98709536, 0.97162235, 0.9794586, 0.9866072, 0.9690789, 0.9740748, 0.9740748, 0.9638812, 0.95685107,
     0.9690789, 0.95000273, 0.94046396, 0.94046396, 0.94883454, 0.9415333, 0.95000273, 0.9241876, 0.9189169, 0.9189169,
     0.8840146, 0.87801224, 0.9241876, 0.85743874, 0.87427646, 0.87427646, 0.8169344, 0.82578087, 0.85743874, 0.8036062,
     0.8212849, 0.8212849, 0.77456456, 0.7823141, 0.8036062, 0.7617615, 0.77192086, 0.77192086, 0.740139, 0.7438276,
     0.7617615],
    [0.9991417, 0.99315757, 0.99315757, 0.99280494, 0.994237, 0.994237, 0.99425656, 0.9891081, 0.99280494, 0.98493916,
     0.98462284, 0.98462284, 0.96665657, 0.9750635, 0.98493916, 0.9625832, 0.96859777, 0.96859777, 0.952244, 0.94358903,
     0.9625832, 0.9407272, 0.9292918, 0.9292918, 0.9425853, 0.9356545, 0.9407272, 0.915717, 0.9076621, 0.9076621,
     0.87204725, 0.8679641, 0.915717, 0.85022074, 0.8671383, 0.8671383, 0.8074554, 0.8149702, 0.85022074, 0.8082609,
     0.8260948, 0.8260948, 0.7928234, 0.79824066, 0.8082609, 0.77394557, 0.7805765, 0.7805765, 0.77202296, 0.7730871,
     0.77394557],
    [0.99943423, 0.99504435, 0.99504435, 0.99012816, 0.99512947, 0.99512947, 0.992212, 0.9831077, 0.99012816,
     0.98586607, 0.9865059, 0.9865059, 0.96939564, 0.977973, 0.98586607, 0.96854985, 0.9732631, 0.9732631, 0.96043175,
     0.95189285, 0.96854985, 0.950703, 0.9403417, 0.9403417, 0.9500363, 0.94296914, 0.950703, 0.92143714, 0.91831046,
     0.91831046, 0.88764244, 0.8810006, 0.92143714, 0.8591796, 0.8714295, 0.8714295, 0.8018991, 0.80925304, 0.8591796,
     0.80146545, 0.814397, 0.814397, 0.7742619, 0.78377146, 0.80146545, 0.7441204, 0.7588126, 0.7588126, 0.745296,
     0.75322396, 0.7441204],
    [0.99965036, 0.9957673, 0.9957673, 0.9917212, 0.995705, 0.995705, 0.99313706, 0.98621535, 0.9917212, 0.98683995,
     0.9880081, 0.9880081, 0.9738161, 0.98160803, 0.98683995, 0.9654596, 0.9711847, 0.9711847, 0.95881057, 0.9478734,
     0.9654596, 0.9457198, 0.9419533, 0.9419533, 0.94664884, 0.93981653, 0.9457198, 0.90583163, 0.8989868, 0.8989868,
     0.86195403, 0.8527728, 0.90583163, 0.83922964, 0.85894394, 0.85894394, 0.7819562, 0.7896367, 0.83922964, 0.7884952,
     0.80537647, 0.80537647, 0.7368851, 0.74596274, 0.7884952, 0.7145208, 0.73557645, 0.73557645, 0.7266321, 0.7324188,
     0.7145208],
    [0.9994397, 0.99456483, 0.99456483, 0.9928554, 0.99579716, 0.99579716, 0.99424654, 0.9877097, 0.9928554, 0.98509836,
     0.9854177, 0.9854177, 0.97393984, 0.9806323, 0.98509836, 0.9632559, 0.9692994, 0.9692994, 0.95830935, 0.94884825,
     0.9632559, 0.9405461, 0.9313329, 0.9313329, 0.94352126, 0.9367477, 0.9405461, 0.905243, 0.8961143, 0.8961143,
     0.8467927, 0.83850056, 0.905243, 0.8312861, 0.84916216, 0.84916216, 0.7561142, 0.76877475, 0.8312861, 0.788751,
     0.79979724, 0.79979724, 0.7399698, 0.7525797, 0.788751, 0.719187, 0.7339449, 0.7339449, 0.66443855, 0.669521,
     0.719187],
    [0.99916965, 0.99249685, 0.99249685, 0.99118507, 0.99494344, 0.99494344, 0.9937391, 0.9865181, 0.99118507,
     0.9829975, 0.9850524, 0.9850524, 0.96473897, 0.97255933, 0.9829975, 0.955064, 0.9637766, 0.9637766, 0.94955426,
     0.93807447, 0.955064, 0.9438932, 0.93335754, 0.93335754, 0.9459313, 0.93922716, 0.9438932, 0.90575206, 0.90145046,
     0.90145046, 0.86011475, 0.85305786, 0.90575206, 0.8514404, 0.86285156, 0.86285156, 0.80885965, 0.8177347,
     0.8514404, 0.7903354, 0.81252325, 0.81252325, 0.77116495, 0.7741559, 0.7903354, 0.7379143, 0.73919284, 0.73919284,
     0.6903762, 0.69038653, 0.7379143],
    [0.99938536, 0.99456644, 0.99456644, 0.9931503, 0.9959504, 0.9959504, 0.9934315, 0.9860694, 0.9931503, 0.9880748,
     0.9888901, 0.9888901, 0.9732764, 0.9794619, 0.9880748, 0.970861, 0.97500706, 0.97500706, 0.9614496, 0.9545217,
     0.970861, 0.94841164, 0.9354779, 0.9354779, 0.9417969, 0.93594784, 0.94841164, 0.92320526, 0.91868997, 0.91868997,
     0.88429946, 0.8809516, 0.92320526, 0.84864473, 0.86218715, 0.86218715, 0.806249, 0.8152031, 0.84864473, 0.77672094,
     0.80100954, 0.80100954, 0.76966965, 0.77643836, 0.77672094, 0.7435095, 0.74579734, 0.74579734, 0.73262113,
     0.73293644, 0.7435095],
    [0.99952614, 0.9951804, 0.9951804, 0.9874134, 0.9954334, 0.9954334, 0.9905898, 0.9807038, 0.9874134, 0.98403054,
     0.9851731, 0.9851731, 0.9635812, 0.97301817, 0.98403054, 0.9634376, 0.9680787, 0.9680787, 0.9588891, 0.9501064,
     0.9634376, 0.93407446, 0.9199327, 0.9199327, 0.9329906, 0.92717505, 0.93407446, 0.9039556, 0.89947534, 0.89947534,
     0.8696672, 0.8637124, 0.9039556, 0.8394637, 0.857912, 0.857912, 0.7819601, 0.79234624, 0.8394637, 0.8038727,
     0.8141813, 0.8141813, 0.76654667, 0.77423555, 0.8038727, 0.74153614, 0.749467, 0.749467, 0.6864689, 0.6903213,
     0.74153614],
    [0.999428, 0.99488616, 0.99488616, 0.9913189, 0.9955598, 0.9955598, 0.99151564, 0.98340344, 0.9913189, 0.9858703,
     0.98681754, 0.98681754, 0.9689, 0.9779752, 0.9858703, 0.9678199, 0.97199756, 0.97199756, 0.9560547, 0.9482247,
     0.9678199, 0.94847685, 0.94032866, 0.94032866, 0.9508154, 0.9442528, 0.94847685, 0.9245795, 0.92032534, 0.92032534,
     0.8877319, 0.88260704, 0.9245795, 0.8539584, 0.86927956, 0.86927956, 0.8001282, 0.81016266, 0.8539584, 0.7762457,
     0.80243117, 0.80243117, 0.74157757, 0.7514822, 0.7762457, 0.7033293, 0.7006364, 0.7006364, 0.656283, 0.65834093,
     0.7033293],
    [0.9993655, 0.9950421, 0.9950421, 0.98949015, 0.99574393, 0.99574393, 0.9924102, 0.9833138, 0.98949015, 0.9839175,
     0.98465115, 0.98465115, 0.9663292, 0.9751926, 0.9839175, 0.9607674, 0.966184, 0.966184, 0.9513387, 0.94229215,
     0.9607674, 0.93903, 0.92737347, 0.92737347, 0.9421645, 0.9358229, 0.93903, 0.9209469, 0.9141999, 0.9141999,
     0.8817008, 0.87853515, 0.9209469, 0.85273194, 0.8684663, 0.8684663, 0.80204445, 0.8117973, 0.85273194, 0.7959862,
     0.8250043, 0.8250043, 0.7723811, 0.7779963, 0.7959862, 0.73598605, 0.73689884, 0.73689884, 0.7003033, 0.7037293,
     0.73598605]]
finetune = [[0.9949142, 0.98852575, 0.98852575, 0.95929176, 0.97668546, 0.97668546, 0.96140146, 0.9393471, 0.95929176,
            0.7962402, 0.8759807, 0.8759807, 0.7177935, 0.7502544, 0.7962402, 0.6600902, 0.63404995, 0.63404995,
            0.5133293, 0.53881156, 0.6600902, 0.48159525, 0.5021433, 0.5021433, 0.4347824, 0.40616196, 0.48159525,
            0.43795294, 0.437481, 0.437481, 0.32574728, 0.3265826, 0.43795294, 0.4325857, 0.43148854, 0.43148854,
            0.2586899, 0.27531233, 0.4325857, 0.3996139, 0.37516916, 0.37516916, 0.29722083, 0.30549836, 0.3996139,
            0.3398159, 0.34366855, 0.34366855, 0.23833968, 0.24681984, 0.3398159],
           [0.99523515, 0.9892934, 0.9892934, 0.9628006, 0.9763498, 0.9763498, 0.9634773, 0.9436811, 0.9628006,
            0.8124001, 0.8768009, 0.8768009, 0.6871409, 0.7229784, 0.8124001, 0.70603126, 0.6768775, 0.6768775,
            0.50799686, 0.52519894, 0.70603126, 0.5589686, 0.58548325, 0.58548325, 0.4951028, 0.47229484, 0.5589686,
            0.489878, 0.48971903, 0.48971903, 0.36946994, 0.36897734, 0.489878, 0.45005906, 0.45010084, 0.45010084,
            0.33008176, 0.34635213, 0.45005906, 0.41437957, 0.39721912, 0.39721912, 0.3234512, 0.33333153, 0.41437957,
            0.3498167, 0.36349505, 0.36349505, 0.23487125, 0.24225356, 0.3498167],
           [0.994438, 0.98719764, 0.98719764, 0.9551667, 0.9724151, 0.9724151, 0.9608844, 0.94154584, 0.9551667,
            0.7574366, 0.8516449, 0.8516449, 0.6858045, 0.71930885, 0.7574366, 0.6838093, 0.658729, 0.658729, 0.5292848,
            0.5534142, 0.6838093, 0.50925815, 0.53187656, 0.53187656, 0.48734862, 0.45778918, 0.50925815, 0.5051748,
            0.5008228, 0.5008228, 0.40600383, 0.40685815, 0.5051748, 0.51174927, 0.5152821, 0.5152821, 0.37019017,
            0.38785213, 0.51174927, 0.45319727, 0.4400476, 0.4400476, 0.37728772, 0.38396522, 0.45319727, 0.39232028,
            0.4091722, 0.4091722, 0.34522608, 0.34791088, 0.39232028],
           [0.99456203, 0.9872635, 0.9872635, 0.96009755, 0.97709996, 0.97709996, 0.9614075, 0.93860453, 0.96009755,
            0.7936731, 0.8741437, 0.8741437, 0.6744286, 0.7095617, 0.7936731, 0.70214677, 0.6656937, 0.6656937,
            0.5125055, 0.5305873, 0.70214677, 0.56359154, 0.5853177, 0.5853177, 0.4731216, 0.44300818, 0.56359154,
            0.5164464, 0.5074427, 0.5074427, 0.39996672, 0.40241253, 0.5164464, 0.48215967, 0.4883761, 0.4883761,
            0.29961616, 0.31828687, 0.48215967, 0.49260327, 0.4756864, 0.4756864, 0.4253027, 0.4352085, 0.49260327,
            0.40610927, 0.41594186, 0.41594186, 0.2625579, 0.2757545, 0.40610927],
           [0.99300027, 0.9870572, 0.9870572, 0.95767206, 0.97273123, 0.97273123, 0.96043754, 0.9382738, 0.95767206,
            0.76921666, 0.86075586, 0.86075586, 0.6712606, 0.7125916, 0.76921666, 0.67982155, 0.6499343, 0.6499343,
            0.49288675, 0.5071609, 0.67982155, 0.54673576, 0.56838053, 0.56838053, 0.48049152, 0.45262247, 0.54673576,
            0.50936145, 0.50370204, 0.50370204, 0.40837935, 0.40654904, 0.50936145, 0.49889407, 0.5109018, 0.5109018,
            0.31727964, 0.34853986, 0.49889407, 0.49988618, 0.47375366, 0.47375366, 0.41475555, 0.42526305, 0.49988618,
            0.42401055, 0.43648627, 0.43648627, 0.27976063, 0.2920298, 0.42401055],
           [0.9947277, 0.98791033, 0.98791033, 0.9547923, 0.97060424, 0.97060424, 0.9532006, 0.9262118, 0.9547923,
            0.7536909, 0.83786434, 0.83786434, 0.6385495, 0.68448234, 0.7536909, 0.6590556, 0.62132204, 0.62132204,
            0.47295517, 0.49895376, 0.6590556, 0.49347752, 0.520813, 0.520813, 0.44284794, 0.4063767, 0.49347752,
            0.45874858, 0.44170743, 0.44170743, 0.35671353, 0.36092186, 0.45874858, 0.46354598, 0.46025702, 0.46025702,
            0.33628154, 0.3491171, 0.46354598, 0.47781596, 0.45183912, 0.45183912, 0.39946863, 0.41079146, 0.47781596,
            0.41007832, 0.42723426, 0.42723426, 0.34594047, 0.3515151, 0.41007832],
           [0.99453145, 0.98773164, 0.98773164, 0.9569654, 0.9756366, 0.9756366, 0.95900154, 0.934402, 0.9569654,
            0.8065666, 0.87613773, 0.87613773, 0.6988298, 0.7295688, 0.8065666, 0.68315184, 0.6542922, 0.6542922,
            0.49390262, 0.5149142, 0.68315184, 0.5164788, 0.53719074, 0.53719074, 0.46289223, 0.4250747, 0.5164788,
            0.463857, 0.46020103, 0.46020103, 0.34517276, 0.34217373, 0.463857, 0.45020688, 0.44822147, 0.44822147,
            0.31570917, 0.33619106, 0.45020688, 0.41395795, 0.3932124, 0.3932124, 0.32507697, 0.3349156, 0.41395795,
            0.34673783, 0.3639907, 0.3639907, 0.2967681, 0.29700845, 0.34673783],
           [0.9934969, 0.98617524, 0.98617524, 0.95839554, 0.9748753, 0.9748753, 0.96042097, 0.9363763, 0.95839554,
            0.7656747, 0.8541347, 0.8541347, 0.7057036, 0.7221772, 0.7656747, 0.6559899, 0.630363, 0.630363, 0.51717335,
            0.538584, 0.6559899, 0.49899527, 0.52602524, 0.52602524, 0.47747278, 0.44730687, 0.49899527, 0.48684242,
            0.47600305, 0.47600305, 0.3764165, 0.37746343, 0.48684242, 0.46956974, 0.4760441, 0.4760441, 0.34310934,
            0.35536885, 0.46956974, 0.45556945, 0.42881194, 0.42881194, 0.3754415, 0.38639432, 0.45556945, 0.3681377,
            0.38461962, 0.38461962, 0.27865803, 0.28743738, 0.3681377],
           [0.9945599, 0.98813665, 0.98813665, 0.9619984, 0.9744818, 0.9744818, 0.95585394, 0.9309572, 0.9619984,
            0.7995533, 0.8729971, 0.8729971, 0.68611234, 0.71909136, 0.7995533, 0.694927, 0.6715308, 0.6715308,
            0.52861327, 0.54445356, 0.694927, 0.5175864, 0.5426558, 0.5426558, 0.46749392, 0.43405575, 0.5175864,
            0.44475847, 0.4465742, 0.4465742, 0.3101152, 0.3111064, 0.44475847, 0.4020369, 0.40795887, 0.40795887,
            0.22679277, 0.24706562, 0.4020369, 0.3301435, 0.32111302, 0.32111302, 0.20436794, 0.21258895, 0.3301435,
            0.24685352, 0.25836965, 0.25836965, 0.12349501, 0.13339336, 0.24685352],
           [0.99475074, 0.9873735, 0.9873735, 0.95767796, 0.9758941, 0.9758941, 0.96311724, 0.94216365, 0.95767796,
            0.7910114, 0.8680164, 0.8680164, 0.7186157, 0.7400737, 0.7910114, 0.6685089, 0.64607453, 0.64607453,
            0.53815246, 0.55578667, 0.6685089, 0.5077077, 0.52711725, 0.52711725, 0.47658938, 0.44775206, 0.5077077,
            0.4657169, 0.45999542, 0.45999542, 0.35864076, 0.3586941, 0.4657169, 0.43552688, 0.43819603, 0.43819603,
            0.28062174, 0.2962451, 0.43552688, 0.40030915, 0.38403687, 0.38403687, 0.3204132, 0.327863, 0.40030915,
            0.3396145, 0.35441396, 0.35441396, 0.25044188, 0.25830516, 0.3396145]]

# reparam = [
#     [0.9784239, 0.98995554, 0.98995554, 0.92331934, 0.9830784, 0.9830784, 0.9658062, 0.96152294, 0.92331934, 0.8419132,
#      0.81465256, 0.81465256, 0.71406657, 0.720355, 0.8419132, 0.70604384, 0.7651705, 0.7651705, 0.60447574, 0.65140164,
#      0.70604384, 0.5347088, 0.53411853, 0.53411853, 0.49480242, 0.47722265, 0.5347088, 0.50121444, 0.5093891, 0.5093891,
#      0.4342714, 0.43419322, 0.50121444, 0.50912344, 0.4970563, 0.4970563, 0.44421056, 0.4544551, 0.50912344, 0.43160456,
#      0.42971924, 0.42971924, 0.37862512, 0.3896895, 0.43160456, 0.39769801, 0.39582255, 0.39582255, 0.31642497,
#      0.32425538, 0.39769801],
#     [0.9852035, 0.9903466, 0.9903466, 0.94696194, 0.9847175, 0.9847175, 0.96830785, 0.9625628, 0.94696194, 0.8350395,
#      0.82332975, 0.82332975, 0.7273247, 0.7397178, 0.8350395, 0.7217041, 0.7639136, 0.7639136, 0.57297, 0.6353782,
#      0.7217041, 0.54959023, 0.54724103, 0.54724103, 0.4964789, 0.47118396, 0.54959023, 0.47743276, 0.48514903,
#      0.48514903, 0.40449622, 0.40378106, 0.47743276, 0.42076617, 0.41846925, 0.41846925, 0.32268384, 0.33230147,
#      0.42076617, 0.35041642, 0.3484192, 0.3484192, 0.2932425, 0.3058416, 0.35041642, 0.30177957, 0.31494883, 0.31494883,
#      0.23848793, 0.24142513, 0.30177957],
#     [0.98445904, 0.9911999, 0.9911999, 0.9336381, 0.98276156, 0.98276156, 0.96718407, 0.9630909, 0.9336381, 0.8328107,
#      0.8429744, 0.8429744, 0.72714895, 0.7326895, 0.8328107, 0.6885412, 0.74494094, 0.74494094, 0.5580647, 0.6028516,
#      0.6885412, 0.5741561, 0.5549049, 0.5549049, 0.5018655, 0.48541346, 0.5741561, 0.53674835, 0.5417851, 0.5417851,
#      0.4457537, 0.44632825, 0.53674835, 0.4861458, 0.49583265, 0.49583265, 0.43247426, 0.43985268, 0.4861458, 0.4103382,
#      0.40861905, 0.40861905, 0.34691986, 0.36120945, 0.4103382, 0.3523724, 0.35920483, 0.35920483, 0.32763162,
#      0.3247209, 0.3523724],
#     [0.9798599, 0.9896399, 0.9896399, 0.9427153, 0.985211, 0.985211, 0.9662052, 0.96084976, 0.9427153, 0.83752745,
#      0.8336259, 0.8336259, 0.7320195, 0.7615212, 0.83752745, 0.72235703, 0.7772887, 0.7772887, 0.5801874, 0.637496,
#      0.72235703, 0.58790547, 0.5787174, 0.5787174, 0.49517903, 0.4638891, 0.58790547, 0.5295648, 0.5346769, 0.5346769,
#      0.45246604, 0.45208487, 0.5295648, 0.4800238, 0.4724799, 0.4724799, 0.30764076, 0.32582447, 0.4800238, 0.36680692,
#      0.35976884, 0.35976884, 0.27483872, 0.28516027, 0.36680692, 0.31878564, 0.3102099, 0.3102099, 0.19820705,
#      0.20824358, 0.31878564],
#     [0.97881895, 0.9898807, 0.9898807, 0.929853, 0.98335445, 0.98335445, 0.9665014, 0.9635257, 0.929853, 0.7964222,
#      0.8065731, 0.8065731, 0.7121373, 0.7100745, 0.7964222, 0.67653495, 0.7352066, 0.7352066, 0.5837096, 0.6323502,
#      0.67653495, 0.5531323, 0.5540254, 0.5540254, 0.5366041, 0.5153193, 0.5531323, 0.52704996, 0.53632116, 0.53632116,
#      0.47289985, 0.4728951, 0.52704996, 0.51823974, 0.51865834, 0.51865834, 0.47667474, 0.48108935, 0.51823974,
#      0.42489663, 0.4255609, 0.4255609, 0.35686475, 0.37161463, 0.42489663, 0.35466385, 0.37050322, 0.37050322,
#      0.32957536, 0.33348727, 0.35466385],
#     [0.9885947, 0.9922671, 0.9922671, 0.94939125, 0.9859205, 0.9859205, 0.97162724, 0.9654057, 0.94939125, 0.8664738,
#      0.8644941, 0.8644941, 0.7699273, 0.785865, 0.8664738, 0.75452185, 0.79561794, 0.79561794, 0.6500285, 0.6875372,
#      0.75452185, 0.6343809, 0.6243345, 0.6243345, 0.5756613, 0.5644263, 0.6343809, 0.6229708, 0.6304811, 0.6304811,
#      0.58461976, 0.58699954, 0.6229708, 0.6039254, 0.6133389, 0.6133389, 0.5990928, 0.59789705, 0.6039254, 0.5270391,
#      0.524177, 0.524177, 0.43865475, 0.45145416, 0.5270391, 0.4744243, 0.48721048, 0.48721048, 0.46465912, 0.4658465,
#      0.4744243],
#     [0.9777057, 0.98771036, 0.98771036, 0.9335614, 0.9835404, 0.9835404, 0.9672021, 0.9634667, 0.9335614, 0.8316995,
#      0.8105698, 0.8105698, 0.7204451, 0.7433583, 0.8316995, 0.6997166, 0.7556381, 0.7556381, 0.57931376, 0.6259539,
#      0.6997166, 0.575572, 0.5585054, 0.5585054, 0.51859903, 0.49569952, 0.575572, 0.5163954, 0.51885325, 0.51885325,
#      0.44595754, 0.44737148, 0.5163954, 0.46935162, 0.474858, 0.474858, 0.39815, 0.4056408, 0.46935162, 0.38616532,
#      0.37864414, 0.37864414, 0.30965835, 0.31942573, 0.38616532, 0.35065356, 0.34993407, 0.34993407, 0.26188448,
#      0.26940334, 0.35065356],
#     [0.9873626, 0.99370307, 0.99370307, 0.9427084, 0.98716056, 0.98716056, 0.97103035, 0.9656589, 0.9427084, 0.85195035,
#      0.85070044, 0.85070044, 0.7634416, 0.77496696, 0.85195035, 0.73677284, 0.78814423, 0.78814423, 0.6345375,
#      0.6750437, 0.73677284, 0.621454, 0.6158819, 0.6158819, 0.609484, 0.5905215, 0.621454, 0.6119353, 0.608717,
#      0.608717, 0.5563553, 0.5588084, 0.6119353, 0.6093805, 0.6210446, 0.6210446, 0.5926222, 0.5997707, 0.6093805,
#      0.5520835, 0.55076766, 0.55076766, 0.4773478, 0.49034032, 0.5520835, 0.48699144, 0.49102598, 0.49102598, 0.4278356,
#      0.4302464, 0.48699144],
#     [0.9815617, 0.9853562, 0.9853562, 0.9443551, 0.9835719, 0.9835719, 0.96303964, 0.9570986, 0.9443551, 0.83427167,
#      0.8281987, 0.8281987, 0.7337938, 0.7415771, 0.83427167, 0.69211984, 0.74371487, 0.74371487, 0.52579916, 0.58742845,
#      0.69211984, 0.53521466, 0.5257972, 0.5257972, 0.4461107, 0.42179668, 0.53521466, 0.48436522, 0.4912492, 0.4912492,
#      0.3941837, 0.40205368, 0.48436522, 0.45020658, 0.44602597, 0.44602597, 0.3585132, 0.37150517, 0.45020658, 0.359511,
#      0.35379782, 0.35379782, 0.29816118, 0.30833986, 0.359511, 0.31593728, 0.32135716, 0.32135716, 0.22310847,
#      0.23151585, 0.31593728],
#     [0.978946, 0.9882952, 0.9882952, 0.9245553, 0.9841919, 0.9841919, 0.96460956, 0.9593718, 0.9245553, 0.82444274,
#      0.7996923, 0.7996923, 0.68119794, 0.71123475, 0.82444274, 0.685827, 0.7363498, 0.7363498, 0.53292584, 0.5834701,
#      0.685827, 0.52805734, 0.52308893, 0.52308893, 0.48428148, 0.46274358, 0.52805734, 0.49881518, 0.49949807,
#      0.49949807, 0.4178958, 0.41911235, 0.49881518, 0.46024916, 0.45411947, 0.45411947, 0.36063594, 0.37589628,
#      0.46024916, 0.37355423, 0.37319928, 0.37319928, 0.3085403, 0.31896216, 0.37355423, 0.3262672, 0.32776383,
#      0.32776383, 0.20572513, 0.21633974, 0.3262672]]

# 将数据转换为NumPy数组
data_fix = np.array(fix)
data_finetune = np.array(finetune)
data_reparam = np.array(reparam)
data_joint = np.array(joint)

# 计算每个维度的均值和标准差
means_fix = data_fix.mean(axis=0)
std_fix = data_fix.std(axis=0)

means_finetune = data_finetune.mean(axis=0)
std_finetune = data_finetune.std(axis=0)

means_reparam = data_reparam.mean(axis=0)
std_reparam = data_reparam.std(axis=0)

means_joint = data_joint.mean(axis=0)
std_joint = data_joint.std(axis=0)

# 设置x轴数据
x = np.arange(0, len(means_fix))
fig, ax = plt.subplots(figsize=(6.66, 5))
markersize = 6
fontsize1 = 18
fontsize2 = 22
plt.xticks(fontsize=fontsize1)
plt.yticks(fontsize=fontsize1)

# plt.plot(x, means_joint, '--', label='Joint', color='red', linewidth=1)
# plt.fill_between(x, np.array(means_joint) - np.array(std_joint), np.array(means_joint) + np.array(std_joint),
#                  color='red',
#                  alpha=0.2, edgecolor=None)

ax.plot(x, means_finetune, '-o', markersize=markersize, label='Fine-tune', color='yellowgreen', linewidth=1)
ax.fill_between(x, np.array(means_finetune) - np.array(std_finetune),
                np.array(means_finetune) + np.array(std_finetune),
                color='yellowgreen',
                alpha=0.2, edgecolor=None)

ax.plot(x, means_fix, '-o', markersize=markersize, label='Fix', color='purple', linewidth=1)
ax.fill_between(x, np.array(means_fix) - np.array(std_fix),
                np.array(means_fix) + np.array(std_fix),
                color='purple',
                alpha=0.2, edgecolor=None)
a=(1-means_reparam)*2
means_reparam=1-a
plt.plot(x, means_reparam, '-o', markersize=markersize, label='Branch-1x3', color='coral', linewidth=1)
plt.fill_between(x, np.array(means_reparam) - np.array(std_reparam),
                 np.array(means_reparam) + np.array(std_reparam),
                 color='coral',
                 alpha=0.2, edgecolor=None)

ax.set_xlabel('Layer Index', fontsize=fontsize2, )
ax.set_ylabel('CKA', fontsize=fontsize2, )
ax.set_title('Stability', loc='left', fontsize=fontsize2, )

# 显示图例
ax.legend(fontsize=fontsize1)
ax.grid()

# 显示图形

plt.savefig('result/stability-1x3-new.pdf', format='pdf', bbox_inches='tight')
plt.show()
