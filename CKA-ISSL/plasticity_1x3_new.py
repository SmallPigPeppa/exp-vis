import numpy as np
import matplotlib.pyplot as plt

joint = [[1.0] * 9] * 9

reparam = [
    [0.9852935, 0.98448324, 0.98448324, 0.9834609, 0.99052745, 0.99052745, 0.9881669, 0.98160845, 0.9834609, 0.8987448,
     0.8542655, 0.8542655, 0.80347174, 0.80847096, 0.8987448, 0.8162199, 0.82959473, 0.82959473, 0.76393634, 0.788548,
     0.8162199, 0.7907949, 0.7650907, 0.7650907, 0.7253192, 0.7018758, 0.7907949, 0.6861197, 0.67502904, 0.67502904,
     0.5259508, 0.5303537, 0.6861197, 0.5412346, 0.52628994, 0.52628994, 0.28635442, 0.3074534, 0.5412346, 0.4846261,
     0.47037828, 0.47037828, 0.33224759, 0.34241655, 0.4846261, 0.38071263, 0.38806516, 0.38806516, 0.18985103,
     0.19768202, 0.38071263],
    [0.98478186, 0.9814315, 0.9814315, 0.9839491, 0.9905693, 0.9905693, 0.98761016, 0.98029345, 0.9839491, 0.91060406,
     0.86565715, 0.86565715, 0.84026575, 0.8466799, 0.91060406, 0.82770413, 0.83096004, 0.83096004, 0.759659, 0.7775858,
     0.82770413, 0.78046143, 0.7556663, 0.7556663, 0.7349702, 0.71601593, 0.78046143, 0.6967848, 0.6885213, 0.6885213,
     0.5605637, 0.5606788, 0.6967848, 0.5549008, 0.55190223, 0.55190223, 0.3280241, 0.34653997, 0.5549008, 0.48671725,
     0.47747016, 0.47747016, 0.30739704, 0.3205203, 0.48671725, 0.4067823, 0.41744307, 0.41744307, 0.21127702,
     0.21846256, 0.4067823],
    [0.9833826, 0.9802897, 0.9802897, 0.9797987, 0.9885399, 0.9885399, 0.9867709, 0.9789025, 0.9797987, 0.90431106,
     0.83495015, 0.83495015, 0.7981402, 0.79743785, 0.90431106, 0.8104982, 0.8246379, 0.8246379, 0.759179, 0.7826841,
     0.8104982, 0.7612221, 0.7346998, 0.7346998, 0.7111338, 0.68637764, 0.7612221, 0.6741384, 0.657435, 0.657435,
     0.5482372, 0.54603124, 0.6741384, 0.56350344, 0.55165815, 0.55165815, 0.31706527, 0.33691528, 0.56350344,
     0.5143354, 0.49778336, 0.49778336, 0.36548102, 0.37832975, 0.5143354, 0.42275062, 0.429106, 0.429106, 0.19327162,
     0.20124136, 0.42275062],
    [0.99212366, 0.98476964, 0.98476964, 0.9873681, 0.99175465, 0.99175465, 0.9879144, 0.9801162, 0.9873681, 0.9195477,
     0.8865718, 0.8865718, 0.85277176, 0.85835344, 0.9195477, 0.83606386, 0.846452, 0.846452, 0.7638266, 0.79367524,
     0.83606386, 0.78850424, 0.7620933, 0.7620933, 0.7270541, 0.6978238, 0.78850424, 0.6903098, 0.6731846, 0.6731846,
     0.5140469, 0.5109064, 0.6903098, 0.55380976, 0.54150814, 0.54150814, 0.25747824, 0.2805199, 0.55380976, 0.48847288,
     0.4667978, 0.4667978, 0.2665658, 0.28027827, 0.48847288, 0.38054585, 0.40412053, 0.40412053, 0.16741213,
     0.17699294, 0.38054585],
    [0.9852866, 0.98189825, 0.98189825, 0.98559165, 0.99029225, 0.99029225, 0.9894595, 0.98388845, 0.98559165,
     0.91462046, 0.86795956, 0.86795956, 0.81729114, 0.82597417, 0.91462046, 0.84020644, 0.852938, 0.852938, 0.7760829,
     0.799629, 0.84020644, 0.7917672, 0.7710856, 0.7710856, 0.74390846, 0.7222938, 0.7917672, 0.7001532, 0.687641,
     0.687641, 0.55338395, 0.55252594, 0.7001532, 0.55894136, 0.54280204, 0.54280204, 0.27636665, 0.29914954,
     0.55894136, 0.5000516, 0.48735687, 0.48735687, 0.33371225, 0.34413368, 0.5000516, 0.4123007, 0.39756984,
     0.39756984, 0.12975268, 0.13883792, 0.4123007],
    [0.98304623, 0.98295546, 0.98295546, 0.9801713, 0.9906467, 0.9906467, 0.9872425, 0.98082733, 0.9801713, 0.9067832,
     0.8433288, 0.8433288, 0.7882312, 0.79009676, 0.9067832, 0.83802, 0.85206586, 0.85206586, 0.8017715, 0.81862515,
     0.83802, 0.8035033, 0.7787039, 0.7787039, 0.75524354, 0.73180395, 0.8035033, 0.7147152, 0.70540446, 0.70540446,
     0.5965942, 0.58851, 0.7147152, 0.601925, 0.5931171, 0.5931171, 0.37052587, 0.39111328, 0.601925, 0.52751136,
     0.5212883, 0.5212883, 0.3839311, 0.3942649, 0.52751136, 0.4452842, 0.45314783, 0.45314783, 0.2179908, 0.22794512,
     0.4452842],
    [0.9774244, 0.98305374, 0.98305374, 0.9829907, 0.99055266, 0.99055266, 0.98817295, 0.9813546, 0.9829907, 0.9005828,
     0.84721106, 0.84721106, 0.8005363, 0.80059147, 0.9005828, 0.82199514, 0.83797204, 0.83797204, 0.77496374,
     0.7947052, 0.82199514, 0.7870782, 0.7623973, 0.7623973, 0.70969087, 0.6845065, 0.7870782, 0.6920163, 0.6845076,
     0.6845076, 0.5575639, 0.5499114, 0.6920163, 0.57843995, 0.5578229, 0.5578229, 0.29814354, 0.3225004, 0.57843995,
     0.533635, 0.51667434, 0.51667434, 0.37430757, 0.38650057, 0.533635, 0.4133638, 0.41783068, 0.41783068, 0.17394432,
     0.18306337, 0.4133638],
    [0.9852528, 0.98448473, 0.98448473, 0.9851395, 0.9885963, 0.9885963, 0.9863745, 0.97824, 0.9851395, 0.8980958,
     0.8574296, 0.8574296, 0.79840106, 0.8088764, 0.8980958, 0.80268, 0.8218765, 0.8218765, 0.747207, 0.7693353,
     0.80268, 0.7654746, 0.74651444, 0.74651444, 0.69575346, 0.6659079, 0.7654746, 0.6580188, 0.6465229, 0.6465229,
     0.4818242, 0.47897327, 0.6580188, 0.5345925, 0.50784326, 0.50784326, 0.20293945, 0.22908717, 0.5345925, 0.4578013,
     0.44469333, 0.44469333, 0.24377257, 0.2542379, 0.4578013, 0.34916285, 0.37375826, 0.37375826, 0.115174845,
     0.12619391, 0.34916285],
    [0.99064326, 0.98528075, 0.98528075, 0.98712695, 0.9920082, 0.9920082, 0.98897976, 0.98286515, 0.98712695,
     0.9160904, 0.87661356, 0.87661356, 0.8538095, 0.8622219, 0.9160904, 0.8366476, 0.83965695, 0.83965695, 0.76669127,
     0.79429966, 0.8366476, 0.7966792, 0.76795673, 0.76795673, 0.72785014, 0.70640254, 0.7966792, 0.7132502, 0.70327324,
     0.70327324, 0.557696, 0.5546064, 0.7132502, 0.59110045, 0.57201195, 0.57201195, 0.30182412, 0.3229588, 0.59110045,
     0.5087654, 0.5165568, 0.5165568, 0.35837898, 0.3678538, 0.5087654, 0.4103446, 0.40983993, 0.40983993, 0.18941662,
     0.19895087, 0.4103446],
    [0.98904717, 0.98205984, 0.98205984, 0.98662716, 0.99109244, 0.99109244, 0.9885982, 0.9817097, 0.98662716,
     0.9098743, 0.8741444, 0.8741444, 0.8496821, 0.86151, 0.9098743, 0.82274216, 0.83137727, 0.83137727, 0.75268435,
     0.7848529, 0.82274216, 0.7981341, 0.7696059, 0.7696059, 0.7247661, 0.70302284, 0.7981341, 0.7225306, 0.7119993,
     0.7119993, 0.5938335, 0.59880483, 0.7225306, 0.6038865, 0.5959861, 0.5959861, 0.37626323, 0.4007428, 0.6038865,
     0.5591461, 0.5522938, 0.5522938, 0.42133942, 0.4329404, 0.5591461, 0.4481005, 0.45941204, 0.45941204, 0.21055359,
     0.21782652, 0.4481005]]

finetune = [
    [0.9980807, 0.9970566, 0.9970566, 0.9965983, 0.9965777, 0.9965777, 0.99636006, 0.99457794, 0.9965983, 0.9863358,
     0.98599285, 0.98599285, 0.9791068, 0.9736936, 0.9863358, 0.95655596, 0.95674825, 0.95674825, 0.9375388, 0.930452,
     0.95655596, 0.9266466, 0.91816896, 0.91816896, 0.8802328, 0.8753332, 0.9266466, 0.86545324, 0.86858803, 0.86858803,
     0.8278643, 0.83055156, 0.86545324, 0.7871865, 0.7861351, 0.7861351, 0.65136063, 0.64974207, 0.7871865, 0.7193254,
     0.7378873, 0.7378873, 0.69343895, 0.6893805, 0.7193254, 0.48450765, 0.55276227, 0.55276227, 0.3389375, 0.34540164,
     0.48450765],
    [0.9981036, 0.9983802, 0.9983802, 0.9959267, 0.99628973, 0.99628973, 0.995713, 0.99368316, 0.9959267, 0.9881695,
     0.985896, 0.985896, 0.9800955, 0.97337866, 0.9881695, 0.95844966, 0.95562446, 0.95562446, 0.9367456, 0.92867786,
     0.95844966, 0.9298229, 0.92049104, 0.92049104, 0.8802189, 0.8784407, 0.9298229, 0.8732043, 0.8796215, 0.8796215,
     0.8426499, 0.845297, 0.8732043, 0.78617543, 0.7947561, 0.7947561, 0.68348736, 0.6828329, 0.78617543, 0.6853659,
     0.7061956, 0.7061956, 0.6335422, 0.63458633, 0.6853659, 0.45671326, 0.5715262, 0.5715262, 0.38204783, 0.39386097,
     0.45671326],
    [0.9978135, 0.996931, 0.996931, 0.9960078, 0.9959572, 0.9959572, 0.9960258, 0.9936988, 0.9960078, 0.98534447,
     0.98368746, 0.98368746, 0.9785969, 0.97185624, 0.98534447, 0.9529073, 0.95262927, 0.95262927, 0.9332523, 0.9251382,
     0.9529073, 0.92369044, 0.91260356, 0.91260356, 0.8721022, 0.8685056, 0.92369044, 0.86737, 0.8715579, 0.8715579,
     0.8400508, 0.8431695, 0.86737, 0.79969406, 0.8004925, 0.8004925, 0.67012745, 0.66818076, 0.79969406, 0.73205566,
     0.74685174, 0.74685174, 0.68303573, 0.6846856, 0.73205566, 0.519121, 0.6283717, 0.6283717, 0.36717987, 0.37540647,
     0.519121],
    [0.99901927, 0.998663, 0.998663, 0.99694216, 0.9972699, 0.9972699, 0.99688643, 0.9958591, 0.99694216, 0.98888266,
     0.98736817, 0.98736817, 0.9819965, 0.9776526, 0.98888266, 0.9624852, 0.9618185, 0.9618185, 0.9360255, 0.9307648,
     0.9624852, 0.93269145, 0.9197025, 0.9197025, 0.8780361, 0.87631816, 0.93269145, 0.87894344, 0.8824427, 0.8824427,
     0.8409151, 0.84523606, 0.87894344, 0.80372137, 0.80195045, 0.80195045, 0.64953595, 0.64735836, 0.80372137,
     0.74454117, 0.76087284, 0.76087284, 0.7002518, 0.69884807, 0.74454117, 0.52639157, 0.61954707, 0.61954707,
     0.3694367, 0.37715867, 0.52639157],
    [0.9980565, 0.9969393, 0.9969393, 0.9961526, 0.99639696, 0.99639696, 0.9964998, 0.99443036, 0.9961526, 0.9883102,
     0.9871004, 0.9871004, 0.98074555, 0.9745037, 0.9883102, 0.95840746, 0.9557015, 0.9557015, 0.9328373, 0.92612505,
     0.95840746, 0.92739326, 0.91370344, 0.91370344, 0.87724036, 0.8732906, 0.92739326, 0.8760057, 0.88057375,
     0.88057375, 0.82937616, 0.83480644, 0.8760057, 0.7984306, 0.7952626, 0.7952626, 0.63422596, 0.632198, 0.7984306,
     0.7313853, 0.7448453, 0.7448453, 0.6569549, 0.65514123, 0.7313853, 0.515506, 0.5898047, 0.5898047, 0.2853003,
     0.29666063, 0.515506],
    [0.9977673, 0.99661016, 0.99661016, 0.9947842, 0.99608964, 0.99608964, 0.9955345, 0.9933946, 0.9947842, 0.98765874,
     0.98503286, 0.98503286, 0.9806771, 0.97375065, 0.98765874, 0.95939857, 0.95932513, 0.95932513, 0.9389094,
     0.9317957, 0.95939857, 0.92866814, 0.9160273, 0.9160273, 0.8872961, 0.8826801, 0.92866814, 0.8704598, 0.88009375,
     0.88009375, 0.8473207, 0.84955496, 0.8704598, 0.7945719, 0.8025151, 0.8025151, 0.7045755, 0.70437866, 0.7945719,
     0.7309447, 0.7524224, 0.7524224, 0.7376486, 0.7363456, 0.7309447, 0.50502473, 0.6247973, 0.6247973, 0.3627181,
     0.37199423, 0.50502473],
    [0.99692446, 0.9965487, 0.9965487, 0.9948055, 0.9964968, 0.9964968, 0.9935362, 0.9897917, 0.9948055, 0.9866205,
     0.9862466, 0.9862466, 0.9800012, 0.9742748, 0.9866205, 0.96077216, 0.9609188, 0.9609188, 0.9408833, 0.9286767,
     0.96077216, 0.92832774, 0.91673, 0.91673, 0.87779063, 0.8723008, 0.92832774, 0.8758592, 0.8822036, 0.8822036,
     0.84987074, 0.8537933, 0.8758592, 0.8054473, 0.8065491, 0.8065491, 0.71317154, 0.71172935, 0.8054473, 0.71150637,
     0.7282416, 0.7282416, 0.6740625, 0.67368597, 0.71150637, 0.48038632, 0.57252854, 0.57252854, 0.37140936, 0.3778346,
     0.48038632],
    [0.9980702, 0.9970349, 0.9970349, 0.9960701, 0.9966489, 0.9966489, 0.9949543, 0.9925584, 0.9960701, 0.98541844,
     0.9843356, 0.9843356, 0.97895193, 0.97363013, 0.98541844, 0.9533896, 0.9513447, 0.9513447, 0.9254706, 0.9145318,
     0.9533896, 0.9182286, 0.9077511, 0.9077511, 0.84599936, 0.8425583, 0.9182286, 0.85261905, 0.85825604, 0.85825604,
     0.81374055, 0.81395674, 0.85261905, 0.7733509, 0.7795907, 0.7795907, 0.64300454, 0.6388389, 0.7733509, 0.6963097,
     0.71449375, 0.71449375, 0.65370363, 0.6513994, 0.6963097, 0.4823634, 0.55834794, 0.55834794, 0.3087947, 0.31801003,
     0.4823634],
    [0.9987645, 0.99906075, 0.99906075, 0.9973139, 0.997272, 0.997272, 0.99740565, 0.996247, 0.9973139, 0.98832035,
     0.98640907, 0.98640907, 0.98167276, 0.976671, 0.98832035, 0.9593164, 0.9554905, 0.9554905, 0.9303304, 0.92677766,
     0.9593164, 0.92799103, 0.9155318, 0.9155318, 0.8742309, 0.8686924, 0.92799103, 0.8762231, 0.8820833, 0.8820833,
     0.8405306, 0.8422951, 0.8762231, 0.8092739, 0.8047075, 0.8047075, 0.67249703, 0.6737784, 0.8092739, 0.75816715,
     0.7679489, 0.7679489, 0.67015094, 0.6723679, 0.75816715, 0.52945375, 0.59732586, 0.59732586, 0.3483852, 0.35542965,
     0.52945375],
    [0.9986352, 0.9988032, 0.9988032, 0.9966822, 0.99662036, 0.99662036, 0.9973532, 0.99621457, 0.9966822, 0.9868682,
     0.98580474, 0.98580474, 0.9792225, 0.9731497, 0.9868682, 0.9576762, 0.95485026, 0.95485026, 0.9325628, 0.92753637,
     0.9576762, 0.92878807, 0.9134945, 0.9134945, 0.8722628, 0.8704199, 0.92878807, 0.87413514, 0.8791173, 0.8791173,
     0.8400686, 0.8436853, 0.87413514, 0.791577, 0.79868364, 0.79868364, 0.6671812, 0.6685489, 0.791577, 0.722047,
     0.7417607, 0.7417607, 0.71244127, 0.71055406, 0.722047, 0.52483994, 0.59666836, 0.59666836, 0.36488435, 0.37455332,
     0.52483994]]
fix = [
    [0.96216094, 0.97246385, 0.97246385, 0.9600656, 0.9674788, 0.9674788, 0.96844906, 0.95333445, 0.9600656, 0.7010763,
     0.7521239, 0.7521239, 0.5508077, 0.58461255, 0.7010763, 0.56567764, 0.5473537, 0.5473537, 0.45650274, 0.46891773,
     0.56567764, 0.496981, 0.5227866, 0.5227866, 0.44352955, 0.4454104, 0.496981, 0.4228692, 0.42825428, 0.42825428,
     0.30639008, 0.3073915, 0.4228692, 0.32912838, 0.32803428, 0.32803428, 0.07575105, 0.090870775, 0.32912838,
     0.31639078, 0.3091405, 0.3091405, 0.14410107, 0.14506048, 0.31639078, 0.31980318, 0.33501306, 0.33501306,
     0.09389277, 0.10487901, 0.31980318],
    [0.9613515, 0.9689097, 0.9689097, 0.95708364, 0.96489835, 0.96489835, 0.962921, 0.9488862, 0.95708364, 0.69486254,
     0.74968874, 0.74968874, 0.5440897, 0.58659494, 0.69486254, 0.5549844, 0.54068685, 0.54068685, 0.44322118, 0.449177,
     0.5549844, 0.49466085, 0.50905716, 0.50905716, 0.41456893, 0.41853842, 0.49466085, 0.44511, 0.4526153, 0.4526153,
     0.32935217, 0.3268208, 0.44511, 0.3546861, 0.3518316, 0.3518316, 0.09368526, 0.108399354, 0.3546861, 0.3165483,
     0.3120945, 0.3120945, 0.13483176, 0.13698505, 0.3165483, 0.30439907, 0.31802958, 0.31802958, 0.09377946,
     0.10565976, 0.30439907],
    [0.95051354, 0.9655839, 0.9655839, 0.9511562, 0.96584326, 0.96584326, 0.96676755, 0.95435625, 0.9511562, 0.679913,
     0.7281023, 0.7281023, 0.53016096, 0.5637108, 0.679913, 0.54384375, 0.52963394, 0.52963394, 0.45674804, 0.4674495,
     0.54384375, 0.4659961, 0.485656, 0.485656, 0.41613573, 0.4134359, 0.4659961, 0.41449022, 0.41792366, 0.41792366,
     0.32042834, 0.32091993, 0.41449022, 0.34070647, 0.3401608, 0.3401608, 0.11533248, 0.12665376, 0.34070647,
     0.31439975, 0.31147158, 0.31147158, 0.18347804, 0.1858295, 0.31439975, 0.33970532, 0.35017976, 0.35017976,
     0.15239145, 0.16592222, 0.33970532],
    [0.9556142, 0.97159886, 0.97159886, 0.95212257, 0.9674704, 0.9674704, 0.9659037, 0.9521961, 0.95212257, 0.6855932,
     0.730806, 0.730806, 0.5400201, 0.5755625, 0.6855932, 0.5600922, 0.53975606, 0.53975606, 0.44115272, 0.44623092,
     0.5600922, 0.4663335, 0.506611, 0.506611, 0.41860992, 0.42132193, 0.4663335, 0.39971524, 0.41075495, 0.41075495,
     0.29549837, 0.2928797, 0.39971524, 0.32083884, 0.32195926, 0.32195926, 0.113378294, 0.12527284, 0.32083884,
     0.2751265, 0.26978713, 0.26978713, 0.12930617, 0.1311686, 0.2751265, 0.2942463, 0.29316455, 0.29316455, 0.10477164,
     0.11524062, 0.2942463],
    [0.9511425, 0.9653233, 0.9653233, 0.9512595, 0.95065325, 0.95065325, 0.96176773, 0.9433528, 0.9512595, 0.6207162,
     0.67931825, 0.67931825, 0.5005681, 0.5018789, 0.6207162, 0.49095148, 0.46417657, 0.46417657, 0.38927922,
     0.39140967, 0.49095148, 0.41101214, 0.40943107, 0.40943107, 0.33012024, 0.33259222, 0.41101214, 0.35782406,
     0.36471242, 0.36471242, 0.2609477, 0.26159537, 0.35782406, 0.28879455, 0.2977961, 0.2977961, 0.081941225,
     0.09690153, 0.28879455, 0.26982856, 0.26601908, 0.26601908, 0.13677812, 0.13763942, 0.26982856, 0.30391786,
     0.28989398, 0.28989398, 0.10072928, 0.10833923, 0.30391786],
    [0.9633374, 0.96521324, 0.96521324, 0.9545842, 0.95962584, 0.95962584, 0.96679527, 0.9560677, 0.9545842, 0.6368902,
     0.6943957, 0.6943957, 0.48308808, 0.5114164, 0.6368902, 0.5169725, 0.5020118, 0.5020118, 0.46187058, 0.47099897,
     0.5169725, 0.42058712, 0.44667077, 0.44667077, 0.39716393, 0.38245925, 0.42058712, 0.34345487, 0.34911492,
     0.34911492, 0.24369082, 0.24335526, 0.34345487, 0.2537814, 0.25587213, 0.25587213, 0.093614794, 0.108892225,
     0.2537814, 0.23137744, 0.22830938, 0.22830938, 0.12966181, 0.12913413, 0.23137744, 0.23503917, 0.24455021,
     0.24455021, 0.08735431, 0.0948319, 0.23503917],
    [0.97372234, 0.96256465, 0.96256465, 0.96240056, 0.96952796, 0.96952796, 0.9740746, 0.9694167, 0.96240056,
     0.6827483, 0.73435813, 0.73435813, 0.5323092, 0.5667696, 0.6827483, 0.5525094, 0.536004, 0.536004, 0.46454683,
     0.46681157, 0.5525094, 0.4738108, 0.48600808, 0.48600808, 0.42028692, 0.41064373, 0.4738108, 0.41738456,
     0.42236897, 0.42236897, 0.30756775, 0.30392024, 0.41738456, 0.3380261, 0.34365314, 0.34365314, 0.14378409,
     0.15966184, 0.3380261, 0.29151985, 0.2896526, 0.2896526, 0.13841183, 0.14067058, 0.29151985, 0.3134416, 0.31303018,
     0.31303018, 0.10208658, 0.11465426, 0.3134416],
    [0.9636953, 0.9714265, 0.9714265, 0.9565588, 0.9673238, 0.9673238, 0.97112995, 0.96028656, 0.9565588, 0.70079863,
     0.74361974, 0.74361974, 0.51628345, 0.5485048, 0.70079863, 0.57507473, 0.5360135, 0.5360135, 0.44334766, 0.4549879,
     0.57507473, 0.4704798, 0.5018742, 0.5018742, 0.41933042, 0.41517076, 0.4704798, 0.39474073, 0.4068829, 0.4068829,
     0.29735902, 0.2928139, 0.39474073, 0.3197298, 0.32923073, 0.32923073, 0.0996004, 0.11600395, 0.3197298, 0.2599609,
     0.25527236, 0.25527236, 0.1250738, 0.12949109, 0.2599609, 0.29701006, 0.30194476, 0.30194476, 0.15845865,
     0.16280974, 0.29701006],
    [0.96362835, 0.96571684, 0.96571684, 0.9513443, 0.96010303, 0.96010303, 0.9655451, 0.9534781, 0.9513443, 0.65636426,
     0.7118642, 0.7118642, 0.51968557, 0.56086916, 0.65636426, 0.5180557, 0.4939096, 0.4939096, 0.41801995, 0.42271975,
     0.5180557, 0.4320575, 0.4509304, 0.4509304, 0.39933082, 0.3979949, 0.4320575, 0.3715509, 0.379739, 0.379739,
     0.27292183, 0.2721985, 0.3715509, 0.2838398, 0.29156777, 0.29156777, 0.09020882, 0.10443075, 0.2838398, 0.2362123,
     0.22990784, 0.22990784, 0.10653522, 0.10656014, 0.2362123, 0.2771068, 0.27162355, 0.27162355, 0.1042363,
     0.11258686, 0.2771068],
    [0.9587918, 0.9561696, 0.9561696, 0.953417, 0.96574616, 0.96574616, 0.96500605, 0.9521853, 0.953417, 0.6504472,
     0.7071288, 0.7071288, 0.50935984, 0.5299227, 0.6504472, 0.500564, 0.46980935, 0.46980935, 0.4134512, 0.41879743,
     0.500564, 0.4122082, 0.4245625, 0.4245625, 0.35620737, 0.350659, 0.4122082, 0.3332263, 0.3443369, 0.3443369,
     0.21956488, 0.2175719, 0.3332263, 0.25042158, 0.254835, 0.254835, 0.07290183, 0.08796353, 0.25042158, 0.2234467,
     0.21622169, 0.21622169, 0.10314833, 0.1042467, 0.2234467, 0.27578253, 0.27722737, 0.27722737, 0.113681644,
     0.12157788, 0.27578253]]

# reparam = [
#     [0.9988097, 0.990381, 0.990381, 0.9534511, 0.97906864, 0.97906864, 0.9728186, 0.97067684, 0.9534511, 0.8096042,
#      0.8481218, 0.8481218, 0.61060715, 0.6472306, 0.8096042, 0.67262465, 0.71956927, 0.71956927, 0.6230867, 0.63393366,
#      0.67262465, 0.5439272, 0.5469169, 0.5469169, 0.50151575, 0.5167216, 0.5439272, 0.48700696, 0.5070151, 0.5070151,
#      0.41367063, 0.41348284, 0.48700696, 0.4174264, 0.3890234, 0.3890234, 0.16573223, 0.17993478, 0.4174264, 0.4153282,
#      0.40809292, 0.40809292, 0.26890272, 0.2717332, 0.4153282, 0.38522977, 0.3669394, 0.3669394, 0.14056481, 0.14712341,
#      0.38522977],
#     [0.998238, 0.9854996, 0.9854996, 0.93911, 0.9705527, 0.9705527, 0.96750224, 0.9645246, 0.93911, 0.76341313,
#      0.81086767, 0.81086767, 0.5738272, 0.6052664, 0.76341313, 0.6076596, 0.67395496, 0.67395496, 0.57714343,
#      0.58827025, 0.6076596, 0.4915121, 0.46881613, 0.46881613, 0.4170698, 0.4241373, 0.4915121, 0.4409251, 0.46515742,
#      0.46515742, 0.36994603, 0.3695027, 0.4409251, 0.36836043, 0.34771645, 0.34771645, 0.18295473, 0.19393641,
#      0.36836043, 0.36676863, 0.35844272, 0.35844272, 0.24432866, 0.24870798, 0.36676863, 0.3490724, 0.33898112,
#      0.33898112, 0.16123967, 0.1684369, 0.3490724],
#     [0.99844927, 0.9897431, 0.9897431, 0.9488183, 0.97885174, 0.97885174, 0.97017294, 0.9682255, 0.9488183, 0.7719018,
#      0.8322612, 0.8322612, 0.5810897, 0.6053592, 0.7719018, 0.5992601, 0.6572149, 0.6572149, 0.5159045, 0.55097526,
#      0.5992601, 0.4530188, 0.44144753, 0.44144753, 0.34980902, 0.3605012, 0.4530188, 0.3945287, 0.4174573, 0.4174573,
#      0.3327018, 0.3269119, 0.3945287, 0.33019373, 0.31071845, 0.31071845, 0.09615308, 0.10482698, 0.33019373,
#      0.33786836, 0.33249098, 0.33249098, 0.19560927, 0.19657461, 0.33786836, 0.35221332, 0.31611678, 0.31611678,
#      0.10133094, 0.109331645, 0.35221332],
#     [0.99861544, 0.98861337, 0.98861337, 0.9482918, 0.9749809, 0.9749809, 0.96983, 0.9674698, 0.9482918, 0.7830329,
#      0.83783, 0.83783, 0.6020003, 0.62855816, 0.7830329, 0.63874364, 0.69608915, 0.69608915, 0.56651485, 0.5875602,
#      0.63874364, 0.519192, 0.49367025, 0.49367025, 0.41141278, 0.4246313, 0.519192, 0.462829, 0.4865641, 0.4865641,
#      0.3854332, 0.38389513, 0.462829, 0.39130586, 0.37281606, 0.37281606, 0.1396855, 0.15624283, 0.39130586, 0.4022564,
#      0.39593154, 0.39593154, 0.24143034, 0.24384448, 0.4022564, 0.3347252, 0.32614422, 0.32614422, 0.10976842,
#      0.11728619, 0.3347252],
#     [0.99884784, 0.99012756, 0.99012756, 0.9573434, 0.9813718, 0.9813718, 0.97192794, 0.9694379, 0.9573434, 0.7800366,
#      0.83281463, 0.83281463, 0.62270117, 0.65126896, 0.7800366, 0.6692176, 0.7256441, 0.7256441, 0.6218519, 0.6292089,
#      0.6692176, 0.5316328, 0.5165396, 0.5165396, 0.46818653, 0.4810258, 0.5316328, 0.49270847, 0.5160644, 0.5160644,
#      0.40606716, 0.40756714, 0.49270847, 0.4350228, 0.41146913, 0.41146913, 0.18502226, 0.20241022, 0.4350228,
#      0.45644906, 0.45239174, 0.45239174, 0.3105452, 0.3131178, 0.45644906, 0.42626423, 0.39988703, 0.39988703,
#      0.15839729, 0.16392514, 0.42626423],
#     [0.99834216, 0.9849614, 0.9849614, 0.9373473, 0.9502573, 0.9502573, 0.96552795, 0.9633813, 0.9373473, 0.7823703,
#      0.8322225, 0.8322225, 0.6189688, 0.65782744, 0.7823703, 0.6325197, 0.68007886, 0.68007886, 0.53469473, 0.55013686,
#      0.6325197, 0.4882623, 0.48191008, 0.48191008, 0.3573476, 0.37988985, 0.4882623, 0.41612926, 0.43967524, 0.43967524,
#      0.32259798, 0.31956136, 0.41612926, 0.33865893, 0.32205603, 0.32205603, 0.08677324, 0.103230454, 0.33865893,
#      0.3458843, 0.3442407, 0.3442407, 0.20517007, 0.21053804, 0.3458843, 0.3202724, 0.2989286, 0.2989286, 0.094105646,
#      0.10010815, 0.3202724],
#     [0.99877954, 0.9921414, 0.9921414, 0.95209795, 0.98108906, 0.98108906, 0.972401, 0.9709992, 0.95209795, 0.81745,
#      0.85326767, 0.85326767, 0.6136619, 0.6620126, 0.81745, 0.66028976, 0.71765673, 0.71765673, 0.5722612, 0.5903086,
#      0.66028976, 0.52889174, 0.50258416, 0.50258416, 0.4253508, 0.4371699, 0.52889174, 0.4818937, 0.5007881, 0.5007881,
#      0.40186423, 0.4001979, 0.4818937, 0.39828876, 0.37956643, 0.37956643, 0.1700299, 0.18631107, 0.39828876,
#      0.39332563, 0.39103848, 0.39103848, 0.23889214, 0.24300075, 0.39332563, 0.37008992, 0.34138525, 0.34138525,
#      0.11441153, 0.12275869, 0.37008992],
#     [0.9985121, 0.9910896, 0.9910896, 0.9460218, 0.9735708, 0.9735708, 0.9709709, 0.9690741, 0.9460218, 0.79646844,
#      0.83057797, 0.83057797, 0.59602827, 0.62587976, 0.79646844, 0.6513019, 0.7129647, 0.7129647, 0.6165351, 0.62263167,
#      0.6513019, 0.51169896, 0.5063969, 0.5063969, 0.45101088, 0.4610763, 0.51169896, 0.47032782, 0.491096, 0.491096,
#      0.41452548, 0.40996414, 0.47032782, 0.4105869, 0.3956585, 0.3956585, 0.19982427, 0.21250299, 0.4105869, 0.42575297,
#      0.42004457, 0.42004457, 0.32606325, 0.32982013, 0.42575297, 0.37758768, 0.36219853, 0.36219853, 0.14996612,
#      0.15675479, 0.37758768],
#     [0.9984116, 0.98542714, 0.98542714, 0.9427541, 0.97467804, 0.97467804, 0.9654758, 0.9635115, 0.9427541, 0.7730416,
#      0.8355815, 0.8355815, 0.5743766, 0.61152816, 0.7730416, 0.63248146, 0.6910857, 0.6910857, 0.56566644, 0.5625372,
#      0.63248146, 0.49760634, 0.48288077, 0.48288077, 0.4143047, 0.4288692, 0.49760634, 0.4614361, 0.48213086,
#      0.48213086, 0.40253338, 0.39896086, 0.4614361, 0.40769878, 0.38583544, 0.38583544, 0.16568491, 0.18364833,
#      0.40769878, 0.38911924, 0.3879351, 0.3879351, 0.24927539, 0.2515718, 0.38911924, 0.34455547, 0.31928247,
#      0.31928247, 0.11946399, 0.124344215, 0.34455547],
#     [0.9980648, 0.98330826, 0.98330826, 0.9304575, 0.9641708, 0.9641708, 0.9562775, 0.95311844, 0.9304575, 0.753297,
#      0.809607, 0.809607, 0.6112959, 0.63680094, 0.753297, 0.64460635, 0.6972484, 0.6972484, 0.58476907, 0.58359367,
#      0.64460635, 0.48232883, 0.4696752, 0.4696752, 0.37175348, 0.38706118, 0.48232883, 0.4370294, 0.46418652,
#      0.46418652, 0.37260982, 0.36949673, 0.4370294, 0.3713107, 0.35724643, 0.35724643, 0.15198198, 0.1675209, 0.3713107,
#      0.35423154, 0.3544275, 0.3544275, 0.2298666, 0.23551117, 0.35423154, 0.3681047, 0.3367186, 0.3367186, 0.1274825,
#      0.13528022, 0.3681047]]


# reparam = [[0.98489547, 0.99218345, 0.99218345, 0.97663796, 0.99210984, 0.99210984, 0.9903618, 0.9843958, 0.97663796,
#             0.90243566, 0.8539683, 0.8539683, 0.7872238, 0.8114782, 0.90243566, 0.8077327, 0.8124542, 0.8124542,
#             0.72747284, 0.7492291, 0.8077327, 0.80351526, 0.78112656, 0.78112656, 0.74982613, 0.7262616, 0.80351526,
#             0.6937943, 0.6940142, 0.6940142, 0.5554191, 0.5628267, 0.6937943, 0.60683084, 0.57652044, 0.57652044,
#             0.29103696, 0.31587452, 0.60683084, 0.58909005, 0.5642314, 0.5642314, 0.3707077, 0.38208702, 0.58909005,
#             0.5194893, 0.50881845, 0.50881845, 0.21264622, 0.22342487, 0.5194893],
#            [0.9852011, 0.9939661, 0.9939661, 0.9764656, 0.9905314, 0.9905314, 0.990001, 0.9831078, 0.9764656,
#             0.90944487, 0.866057, 0.866057, 0.83547664, 0.85125566, 0.90944487, 0.8112048, 0.808834, 0.808834,
#             0.71036494, 0.7262244, 0.8112048, 0.788112, 0.7659199, 0.7659199, 0.7334105, 0.71361816, 0.788112,
#             0.6766835, 0.68125945, 0.68125945, 0.53955203, 0.5433588, 0.6766835, 0.57394314, 0.552831, 0.552831,
#             0.2838055, 0.30843198, 0.57394314, 0.56962925, 0.5453719, 0.5453719, 0.34423426, 0.35556477, 0.56962925,
#             0.4863912, 0.48052946, 0.48052946, 0.19386071, 0.20754376, 0.4863912],
#            [0.98295665, 0.9900828, 0.9900828, 0.97009027, 0.99057925, 0.99057925, 0.9876472, 0.9794706, 0.97009027,
#             0.9039789, 0.83728427, 0.83728427, 0.7789283, 0.8007778, 0.9039789, 0.80430406, 0.81038153, 0.81038153,
#             0.72417116, 0.7378964, 0.80430406, 0.7763611, 0.75268245, 0.75268245, 0.72804224, 0.703058, 0.7763611,
#             0.6750332, 0.67658085, 0.67658085, 0.5686048, 0.5756512, 0.6750332, 0.59625655, 0.5727157, 0.5727157,
#             0.31897512, 0.34266868, 0.59625655, 0.6112145, 0.58077747, 0.58077747, 0.4080085, 0.42190585, 0.6112145,
#             0.5506699, 0.5431778, 0.5431778, 0.2366226, 0.2483554, 0.5506699],
#            [0.99220276, 0.99552363, 0.99552363, 0.9830766, 0.9920949, 0.9920949, 0.99047697, 0.9842247, 0.9830766,
#             0.92087203, 0.8847346, 0.8847346, 0.8509033, 0.8669758, 0.92087203, 0.83183086, 0.8349516, 0.8349516,
#             0.733828, 0.7600435, 0.83183086, 0.806224, 0.7839075, 0.7839075, 0.759719, 0.7344596, 0.806224, 0.70271236,
#             0.6990657, 0.6990657, 0.54765946, 0.55439097, 0.70271236, 0.5996113, 0.56914866, 0.56914866, 0.26924366,
#             0.29497746, 0.5996113, 0.5833412, 0.5640121, 0.5640121, 0.3344399, 0.34907177, 0.5833412, 0.503517,
#             0.4930208, 0.4930208, 0.19002944, 0.19968618, 0.503517],
#            [0.9842686, 0.99274236, 0.99274236, 0.97857505, 0.99155366, 0.99155366, 0.99162954, 0.9855367, 0.97857505,
#             0.91442055, 0.8691995, 0.8691995, 0.8020707, 0.82507735, 0.91442055, 0.8286013, 0.8341614, 0.8341614,
#             0.74321455, 0.7583329, 0.8286013, 0.8031303, 0.7790541, 0.7790541, 0.75528973, 0.73133177, 0.8031303,
#             0.7053133, 0.7026302, 0.7026302, 0.5596655, 0.5698577, 0.7053133, 0.6027692, 0.57387197, 0.57387197,
#             0.23750143, 0.2660494, 0.6027692, 0.60221004, 0.5757329, 0.5757329, 0.36228377, 0.37466916, 0.60221004,
#             0.53525084, 0.5079007, 0.5079007, 0.14607835, 0.15767425, 0.53525084],
#            [0.9826693, 0.9922746, 0.9922746, 0.97175926, 0.99014527, 0.99014527, 0.98840195, 0.98173296, 0.97175926,
#             0.9088522, 0.8380265, 0.8380265, 0.7580076, 0.77948844, 0.9088522, 0.8340937, 0.83867675, 0.83867675,
#             0.7652134, 0.78005546, 0.8340937, 0.81425804, 0.7962163, 0.7962163, 0.7794958, 0.7526816, 0.81425804,
#             0.72264874, 0.72679394, 0.72679394, 0.6205349, 0.62428635, 0.72264874, 0.65517634, 0.62886906, 0.62886906,
#             0.38996, 0.414302, 0.65517634, 0.6597548, 0.6338747, 0.6338747, 0.4840164, 0.49580026, 0.6597548, 0.572608,
#             0.5608565, 0.5608565, 0.26522705, 0.2748621, 0.572608],
#            [0.97627306, 0.99470955, 0.99470955, 0.9754032, 0.99046993, 0.99046993, 0.9897404, 0.98258126, 0.9754032,
#             0.9030899, 0.8472722, 0.8472722, 0.7804962, 0.79897994, 0.9030899, 0.81586254, 0.82497716, 0.82497716,
#             0.7393542, 0.754144, 0.81586254, 0.7966915, 0.78151166, 0.78151166, 0.7305877, 0.7017727, 0.7966915,
#             0.6782953, 0.68389356, 0.68389356, 0.5591395, 0.5588061, 0.6782953, 0.58670914, 0.5630963, 0.5630963,
#             0.2978208, 0.3275795, 0.58670914, 0.58487284, 0.547588, 0.547588, 0.37115335, 0.38407552, 0.58487284,
#             0.5064182, 0.50564355, 0.50564355, 0.23233637, 0.24362533, 0.5064182],
#            [0.98525727, 0.99274254, 0.99274254, 0.97879803, 0.99084914, 0.99084914, 0.98908997, 0.9823613, 0.97879803,
#             0.8932762, 0.85107, 0.85107, 0.77750427, 0.80442077, 0.8932762, 0.7974171, 0.8071185, 0.8071185, 0.7187083,
#             0.7299897, 0.7974171, 0.78091884, 0.7631682, 0.7631682, 0.7221572, 0.6950376, 0.78091884, 0.6701166,
#             0.66940904, 0.66940904, 0.5102295, 0.5113103, 0.6701166, 0.5814794, 0.5461096, 0.5461096, 0.19427203,
#             0.22516216, 0.5814794, 0.55842865, 0.53499734, 0.53499734, 0.2930151, 0.30513576, 0.55842865, 0.48093358,
#             0.48083887, 0.48083887, 0.16461919, 0.17544827, 0.48093358],
#            [0.990432, 0.99543315, 0.99543315, 0.9814229, 0.9921961, 0.9921961, 0.9912864, 0.984872, 0.9814229,
#             0.9108984, 0.87030154, 0.87030154, 0.8424832, 0.8625495, 0.9108984, 0.82128894, 0.82156783, 0.82156783,
#             0.7351462, 0.7582019, 0.82128894, 0.7987279, 0.7722104, 0.7722104, 0.7383781, 0.71710896, 0.7987279,
#             0.6984302, 0.7012966, 0.7012966, 0.56962246, 0.57066107, 0.6984302, 0.6081416, 0.58334243, 0.58334243,
#             0.25506392, 0.28459057, 0.6081416, 0.616216, 0.59915626, 0.59915626, 0.38933316, 0.40194312, 0.616216,
#             0.5257259, 0.5119867, 0.5119867, 0.20356236, 0.21567914, 0.5257259],
#            [0.9890895, 0.992459, 0.992459, 0.97942716, 0.9911504, 0.9911504, 0.9901311, 0.9831779, 0.97942716,
#             0.9102172, 0.87458694, 0.87458694, 0.84932786, 0.86947685, 0.9102172, 0.81630516, 0.8192572, 0.8192572,
#             0.71743697, 0.7467285, 0.81630516, 0.8008822, 0.7764491, 0.7764491, 0.7250407, 0.70379066, 0.8008822,
#             0.69547814, 0.6929409, 0.6929409, 0.5590776, 0.5669392, 0.69547814, 0.58941334, 0.5686899, 0.5686899,
#             0.2773116, 0.30823937, 0.58941334, 0.6061143, 0.57729733, 0.57729733, 0.39261472, 0.4062033, 0.6061143,
#             0.52856255, 0.5168933, 0.5168933, 0.2154168, 0.22768673, 0.52856255]]
# 将数据转换为NumPy数组
data_fix = np.array(fix)
data_finetune = np.array(finetune)
data_reparam = np.array(reparam)
data_joint = np.array(joint)

# 计算每个维度的均值和标准差
means_fix = data_fix.mean(axis=0)
std_fix = data_fix.std(axis=0)

means_finetune = data_finetune.mean(axis=0)
std_finetune = data_finetune.std(axis=0)

means_reparam = data_reparam.mean(axis=0)
std_reparam = data_reparam.std(axis=0)

means_joint = data_joint.mean(axis=0)
std_joint = data_joint.std(axis=0)

# 设置x轴数据
x = np.arange(0, len(means_fix))
fig, ax = plt.subplots(figsize=(6.66, 5))
markersize = 6
fontsize1 = 18
fontsize2 = 22
plt.xticks(fontsize=fontsize1)
plt.yticks(fontsize=fontsize1)

# plt.plot(x, means_joint, '--', label='Joint', color='red', linewidth=1)
# plt.fill_between(x, np.array(means_joint) - np.array(std_joint), np.array(means_joint) + np.array(std_joint),
#                  color='red',
#                  alpha=0.2, edgecolor=None)
# means_finetune[49] += 0.55
# means_finetune[48] += 0.56
# means_finetune[36:38] += 0.15
# means_finetune[42:44] += 0.15
ax.plot(x, means_finetune, '-o', markersize=markersize, label='Fine-tune', color='yellowgreen', linewidth=1)
ax.fill_between(x, np.array(means_finetune) - np.array(std_finetune),
                np.array(means_finetune) + np.array(std_finetune),
                color='yellowgreen',
                alpha=0.2, edgecolor=None)

ax.plot(x, means_fix, '-o', markersize=markersize, label='Fix', color='purple', linewidth=1)
ax.fill_between(x, np.array(means_fix) - np.array(std_fix),
                np.array(means_fix) + np.array(std_fix),
                color='purple',
                alpha=0.2, edgecolor=None)

# means_reparam[44:48] += 0.07
# means_reparam[50] += 0.07
plt.plot(x, means_reparam, '-o', markersize=markersize, label='Branch-1x3', color='coral', linewidth=1)
plt.fill_between(x, np.array(means_reparam) - np.array(std_reparam),
                 np.array(means_reparam) + np.array(std_reparam),
                 color='coral',
                 alpha=0.2, edgecolor=None)

ax.set_xlabel('Layer Index', fontsize=fontsize2)
ax.set_ylabel('CKA', fontsize=fontsize2)
ax.set_title('Plasticity', loc='left', fontsize=fontsize2)

# 显示图例
ax.legend(fontsize=fontsize1)
ax.grid()

# 显示图形

plt.savefig('result/plasticity-1x3-new.pdf', format='pdf', bbox_inches='tight')
plt.show()
